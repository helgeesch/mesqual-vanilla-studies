
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.mesqual.io/mesqual-package-documentation/api_reference/datasets/">
      
      
        <link rel="prev" href="../study_manager/">
      
      
        <link rel="next" href="../flag/">
      
      
      <link rel="icon" href="../../../assets/logo-turq.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Datasets - MESQUAL Suite Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dataset-references" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MESQUAL Suite Documentation" class="md-header__button md-logo" aria-label="MESQUAL Suite Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MESQUAL Suite Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Datasets
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/helgeesch/mesqual-vanilla-studies/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../about_mesqual/" class="md-tabs__link">
          
  
  
  MESQUAL API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../studies_examples/" class="md-tabs__link">
        
  
  
    
  
  Studies & Examples

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MESQUAL Suite Documentation" class="md-nav__button md-logo" aria-label="MESQUAL Suite Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo-white.svg" alt="logo">

    </a>
    MESQUAL Suite Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/helgeesch/mesqual-vanilla-studies/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to MESQUAL Suite Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about_mesqual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About MESQUAL Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about_vanilla_studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Vanilla Studies Repository
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    MESQUAL API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            MESQUAL API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../about_mesqual/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StudyManager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mesqual.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.accepted_flags" class="md-nav__link">
    <span class="md-ellipsis">
      accepted_flags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.flag_index" class="md-nav__link">
    <span class="md-ellipsis">
      flag_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.database" class="md-nav__link">
    <span class="md-ellipsis">
      database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.parent_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      parent_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.instance_config" class="md-nav__link">
    <span class="md-ellipsis">
      instance_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_accepted_flags_containing_x" class="md-nav__link">
    <span class="md-ellipsis">
      get_accepted_flags_containing_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.flag_is_accepted" class="md-nav__link">
    <span class="md-ellipsis">
      flag_is_accepted
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.dotfetch" class="md-nav__link">
    <span class="md-ellipsis">
      dotfetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpis_from_definitions" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpis_from_definitions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpis" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpi" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.clear_kpi_collection" class="md-nav__link">
    <span class="md-ellipsis">
      clear_kpi_collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_attributes_series" class="md-nav__link">
    <span class="md-ellipsis">
      get_attributes_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.required_flags_for_flag" class="md-nav__link">
    <span class="md-ellipsis">
      required_flags_for_flag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch_multiple_flags_and_concat" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_multiple_flags_and_concat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch_filter_groupby_agg" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_filter_groupby_agg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_flag_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_flag_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_flag_index_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_flag_index_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_config_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_instance_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_instance_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_instance_config_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      set_instance_config_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_class_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_class_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection.get_merged_kpi_collection" class="md-nav__link">
    <span class="md-ellipsis">
      get_merged_kpi_collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection.fetch_merged" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_merged
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetLinkCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetLinkCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetLinkCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetLinkCollection.get_dataset_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset_by_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetMergeCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetMergeCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConcatCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetConcatCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetComparison" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetComparison
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetComparison">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetComparison.fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.PlatformDataset" class="md-nav__link">
    <span class="md-ellipsis">
      PlatformDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlatformDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.PlatformDataset.register_interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      register_interpreter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig.merge" class="md-nav__link">
    <span class="md-ellipsis">
      merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flag System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Units
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../kpis/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    KPIs
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            KPIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Core Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/kpi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KPI & Attributes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KPI Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/aggregations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aggregations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../kpis/builders/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Builders
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Builders
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/builders/flag_agg_builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flag Agg Builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/builders/comparison_builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison Builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/builders/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Builder Class
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../kpis/definitions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Definitions
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Definitions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/definitions/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Definition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/definitions/flag_aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flag Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/definitions/comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/definitions/custom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../visualization/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Visualization Modules
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Visualization Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/time_series_dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TimeSeriesDashboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../visualization/folium_viz_system/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Folium Viz System
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Folium Viz System
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/areas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Areas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/circle_marker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Circle Marker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/text_overlay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Overlay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/lines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/line_text_overlay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Line Text Overlay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/arrow_icon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arrow Icon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2_7" id="__nav_2_3_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2_7">
            <span class="md-nav__icon md-icon"></span>
            Base
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abstract System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/data_item/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Item
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/kpi_collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KPI Collection Visualizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/folium_viz_system/legends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Legends
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/html_table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTML Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/html_dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTML Dashboard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../energy_data_handling/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Energy Data Handling
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Energy Data Handling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../energy_data_handling/area_accounting/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Area Accounting
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_1" id="__nav_2_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            Area Accounting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/area_accounting/model_gen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Area / Border Model Generators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/area_accounting/area_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Area Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/area_accounting/border_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Border Variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../energy_data_handling/model_handling/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Model Membership Handling
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            Model Membership Handling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/model_handling/property_enricher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Property Enricher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/model_handling/pairs_appender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pairs Appender
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../energy_data_handling/variable_utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Variable Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Variable Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/variable_utils/in_common_aggs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    In-common Aggregations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/variable_utils/direction_aggs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Up-/Down Directional Aggregations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/variable_utils/congestion_rent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Congestion Rent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/variable_utils/regional_trade_balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regional Trade Balance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/granularity_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Granularity Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/network_lines_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Lines Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy_data_handling/time_series_gap_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Series Gap Handling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../utils/pandas_utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pandas_utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_1" id="__nav_2_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_1">
            <span class="md-nav__icon md-icon"></span>
            pandas_utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/flatten_df/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flatten DF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/pend_props/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pend Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/filter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filter by Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/xs_df/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    xs DF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/sort_multiindex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sort MultiIndex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/merge_multi_index_levels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Merge MultiIndex Levels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/set_new_column/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Set New Column in MultiIndex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/pandas_utils/combine_dfs.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Combine DFs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../utils/plotly_utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    plotly_utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_2" id="__nav_2_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            plotly_utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/plotly_utils/plotly_theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PlotlyTheme
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/plotly_utils/figure_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    figure_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/plotly_utils/px_category_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    px_category_utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../utils/folium_utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    folium_utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_3" id="__nav_2_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            folium_utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/folium_utils/screenshotter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Screenshotter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../studies_examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Studies & Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Studies & Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../mesqual-study-01/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Intro to MESQUAL
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Intro to MESQUAL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_101_study_manager_and_basic_fetching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 101: StudyManager and Dataset Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_102_mastering_data_fetching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 102: Advanced Data Fetching Techniques
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_103_scenario_attributes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 103: Scenario Attributes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    KPI Framework
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            KPI Framework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_201_kpi_framework_and_units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 201: KPI Framework and Unit Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_202_kpi_collections_and_tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 202: KPI Collections and Pretty Tables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_301_time_series_dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 301: Time Series Dashboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_302_segmented_colormap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 302: Segmented Colormap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_303_folium_model_df_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 303: Folium Model Data Visualization - Areas, Points, and Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_304_folium_area_kpi_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 304: Folium KPI Visualization System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_307_country_plotter_util/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 307: Country Plotter Utility Module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-01/notebooks/mesqual_308_html_dashboards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MESQUAL 305: HTML Dashboard Utility
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../mesqual-study-02/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    PyPSA EUR Example
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            PyPSA EUR Example
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/scripts/a_study_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Study Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/scripts/b_simple_fetch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Fetch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/scripts/c_trade_balance_heatmap_dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trade Balance Heatmap Dashboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/scripts/c_trade_balance_line_fig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trade Balance Line Chart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/scripts/d_netpos_price_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Net Position & Price Map
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Source
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Source
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/src/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/src/study_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Study Dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/src/study_database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Study Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-02/docs/src/study_interpreters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Study Interpreters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mesqual-study-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plexos Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mesqual.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.accepted_flags" class="md-nav__link">
    <span class="md-ellipsis">
      accepted_flags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.flag_index" class="md-nav__link">
    <span class="md-ellipsis">
      flag_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.database" class="md-nav__link">
    <span class="md-ellipsis">
      database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.parent_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      parent_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.instance_config" class="md-nav__link">
    <span class="md-ellipsis">
      instance_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_accepted_flags_containing_x" class="md-nav__link">
    <span class="md-ellipsis">
      get_accepted_flags_containing_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.flag_is_accepted" class="md-nav__link">
    <span class="md-ellipsis">
      flag_is_accepted
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.dotfetch" class="md-nav__link">
    <span class="md-ellipsis">
      dotfetch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpis_from_definitions" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpis_from_definitions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpis" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.add_kpi" class="md-nav__link">
    <span class="md-ellipsis">
      add_kpi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.clear_kpi_collection" class="md-nav__link">
    <span class="md-ellipsis">
      clear_kpi_collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_attributes_series" class="md-nav__link">
    <span class="md-ellipsis">
      get_attributes_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.required_flags_for_flag" class="md-nav__link">
    <span class="md-ellipsis">
      required_flags_for_flag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch_multiple_flags_and_concat" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_multiple_flags_and_concat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.fetch_filter_groupby_agg" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_filter_groupby_agg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_flag_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_flag_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_flag_index_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_flag_index_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.get_config_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_instance_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_instance_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_instance_config_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      set_instance_config_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.Dataset.set_class_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_class_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection.get_merged_kpi_collection" class="md-nav__link">
    <span class="md-ellipsis">
      get_merged_kpi_collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetCollection.fetch_merged" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_merged
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetLinkCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetLinkCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetLinkCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetLinkCollection.get_dataset_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset_by_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetMergeCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetMergeCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConcatCollection" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetConcatCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetComparison" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetComparison
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetComparison">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetComparison.fetch" class="md-nav__link">
    <span class="md-ellipsis">
      fetch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.PlatformDataset" class="md-nav__link">
    <span class="md-ellipsis">
      PlatformDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlatformDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.PlatformDataset.register_interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      register_interpreter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig.merge" class="md-nav__link">
    <span class="md-ellipsis">
      merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesqual.datasets.DatasetConfig.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="dataset-references">Dataset References<a class="headerlink" href="#dataset-references" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="mesqual.datasets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">datasets</span>


<a href="#mesqual.datasets" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Dataset module providing the core data access layer for MESQUAL.</p>
<p>This module implements the foundational "Everything is a Dataset" principle,
where all data sourcesindividual scenarios, merged scenarios, collections,
and comparisonsshare a unified interface through the <code>.fetch(flag)</code> pattern.</p>


<details class="core-classes" open>
  <summary>Core Classes</summary>
  <p>Dataset: Abstract base class defining the universal data access interface.
    All dataset types inherit from this class and implement the <code>fetch()</code> method.</p>
<p>DatasetCollection: Base class for grouping related datasets together.
    Provides iteration and batch operations across multiple datasets.</p>
<p>DatasetLinkCollection: Collection maintaining parent-child relationships.
    Used when datasets need to reference back to their container.</p>
<p>DatasetMergeCollection: Combines multiple datasets by merging their data.
    Useful for aggregating results from different simulation runs.</p>
<p>DatasetSumCollection: Aggregates datasets by summing numeric values.
    Commonly used for capacity or production totals across scenarios.</p>
<p>DatasetConcatCollection: Concatenates datasets along a specified axis.
    Creates MultiIndex structures preserving scenario identities.</p>
<p>DatasetComparison: Computes differences between scenario pairs.
    Enables delta analysis and comparative studies.</p>
<p>DatasetConcatCollectionOfComparisons: Specialized collection for comparisons.
    Facilitates systematic comparison across multiple scenario pairs.</p>
<p>PlatformDataset: Dataset subclass for platform-specific implementations.
    Extended by platform interfaces (e.g., PyPSA, PLEXOS) to provide
    platform-aware data access.</p>
<p>DatasetConfig: Configuration class controlling dataset behavior.
    Manages caching, post-processing, and platform-specific options.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>Basic usage pattern::</p>
<div class="highlight"><pre><span></span><code>from mesqual.datasets import Dataset, DatasetConfig

# Fetch data from a dataset
prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)

# Configure dataset behavior
config = DatasetConfig(use_database=True)
dataset.set_instance_config(config)

# Work with collections
for scenario in collection:
    data = scenario.fetch(&#39;generators_t.p&#39;)
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>:mod:<code>mesqual.flag</code>: Flag types and flag index implementations</li>
<li>:mod:<code>mesqual.kpis</code>: KPI calculation framework</li>
<li>:mod:<code>mesqual.databases</code>: Caching backends for datasets</li>
</ul>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.Dataset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Dataset</span>


<a href="#mesqual.datasets.Dataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for all datasets in the MESQUAL framework.</p>
<p>The Dataset class provides the fundamental interface for data access and manipulation
in MESQUAL. It implements the core principle "Everything is a Dataset" where individual
scenarios, scenarios merged from multiple simulation runs or data sources,
collections of scenarios, and scenario comparisons all share the same unified interface.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Unified <code>.fetch(flag)</code> interface for data access</li>
<li>Attribute management for scenario metadata</li>
<li>KPI calculation integrations</li>
<li>Database caching support</li>
<li>Dot notation fetching via <code>dotfetch()</code></li>
<li>Type-safe generic implementation</li>
</ul>
</details>

<p>
      <span class="doc-section-title">
        Class Type Parameters:
      </span>
    </p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Bound or Constraints</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DatasetConfigType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration class for dataset behavior</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type used for data flag identification (typically str)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagIndexType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag index implementation for flag mapping</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.Dataset.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable identifier for the dataset</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.Dataset.kpi_collection">kpi_collection</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            KPICollection (mesqual.kpis.collection.KPICollection)" href="../kpis/collection/#mesqual.kpis.collection.KPICollection">KPICollection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collection of KPIs associated with this dataset</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Basic usage pattern
&gt;&gt;&gt; data = dataset.fetch(&#39;buses_t.marginal_price&#39;)
&gt;&gt;&gt; flags = dataset.accepted_flags
&gt;&gt;&gt; if dataset.flag_is_accepted(&#39;generators_t.p&#39;):
...     gen_data = dataset.fetch(&#39;generators_t.p&#39;)
</code></pre></div>








              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Dataset</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for all datasets in the MESQUAL framework.</span>

<span class="sd">    The Dataset class provides the fundamental interface for data access and manipulation</span>
<span class="sd">    in MESQUAL. It implements the core principle &quot;Everything is a Dataset&quot; where individual</span>
<span class="sd">    scenarios, scenarios merged from multiple simulation runs or data sources,</span>
<span class="sd">    collections of scenarios, and scenario comparisons all share the same unified interface.</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - Unified `.fetch(flag)` interface for data access</span>
<span class="sd">        - Attribute management for scenario metadata</span>
<span class="sd">        - KPI calculation integrations</span>
<span class="sd">        - Database caching support</span>
<span class="sd">        - Dot notation fetching via `dotfetch()`</span>
<span class="sd">        - Type-safe generic implementation</span>

<span class="sd">    Type Parameters:</span>
<span class="sd">        DatasetConfigType: Configuration class for dataset behavior</span>
<span class="sd">        FlagType: Type used for data flag identification (typically str)</span>
<span class="sd">        FlagIndexType: Flag index implementation for flag mapping</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name (str): Human-readable identifier for the dataset</span>
<span class="sd">        kpi_collection (KPICollection): Collection of KPIs associated with this dataset</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Basic usage pattern</span>
<span class="sd">        &gt;&gt;&gt; data = dataset.fetch(&#39;buses_t.marginal_price&#39;)</span>
<span class="sd">        &gt;&gt;&gt; flags = dataset.accepted_flags</span>
<span class="sd">        &gt;&gt;&gt; if dataset.flag_is_accepted(&#39;generators_t.p&#39;):</span>
<span class="sd">        ...     gen_data = dataset.fetch(&#39;generators_t.p&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndexType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new Dataset instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Human-readable identifier. If None, auto-generates from class name</span>
<span class="sd">            parent_dataset: Optional parent dataset for hierarchical relationships</span>
<span class="sd">            flag_index: Index for mapping and validating data flags</span>
<span class="sd">            attributes: Dictionary of metadata attributes for the dataset</span>
<span class="sd">            database: Optional database for caching expensive computations</span>
<span class="sd">            config: Configuration object controlling dataset behavior</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span> <span class="o">=</span> <span class="n">flag_index</span> <span class="ow">or</span> <span class="n">EmptyFlagIndex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_dataset</span> <span class="o">=</span> <span class="n">parent_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">attributes</span> <span class="ow">or</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="p">:</span> <span class="n">KPICollection</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>

    <span class="nd">@flag_must_be_accepted</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch data associated with a specific flag.</span>

<span class="sd">        This is the primary method for data access in MESQUAL datasets. It provides</span>
<span class="sd">        a unified interface for retrieving data regardless of the underlying source</span>
<span class="sd">        or dataset type. The method includes automatic caching, post-processing,</span>
<span class="sd">        and configuration management.</span>

<span class="sd">        Configuration Override Behavior:</span>

<span class="sd">            The ``config`` parameter allows fetch-time overrides of dataset behavior.</span>
<span class="sd">            These overrides are merged with the dataset&#39;s effective configuration</span>
<span class="sd">            (which combines class-level and instance-level settings). Only non-None</span>
<span class="sd">            values in the override will replace the existing settings.</span>

<span class="sd">        The configuration resolution hierarchy (later overrides earlier):</span>

<span class="sd">            1. Base config defaults</span>
<span class="sd">            2. Class config (via DatasetConfigManager)</span>
<span class="sd">            3. Instance config (passed to Dataset.__init__)</span>
<span class="sd">            4. **Fetch-time config (this parameter)**</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: Data identifier flag (must be in accepted_flags)</span>
<span class="sd">            config: Optional configuration to override dataset defaults.</span>
<span class="sd">                Can be either:</span>

<span class="sd">                - **dict**: Quick way to override specific settings. Keys must</span>
<span class="sd">                  match config attribute names (e.g., ``use_database``,</span>
<span class="sd">                  ``auto_sort_datetime_index``). Platform-specific options</span>
<span class="sd">                  are also supported if the dataset uses an extended config.</span>

<span class="sd">                - **DatasetConfig instance**: Full config object for type safety.</span>
<span class="sd">                  Must be compatible with the dataset&#39;s config type.</span>

<span class="sd">            **kwargs: Additional keyword arguments passed to the underlying</span>
<span class="sd">                data fetching implementation</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame or Series containing the requested data</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the flag is not accepted by this dataset</span>

<span class="sd">        Examples:</span>
<span class="sd">            Basic usage::</span>

<span class="sd">                &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)</span>

<span class="sd">            Override base config options with a dict::</span>

<span class="sd">                &gt;&gt;&gt; # Skip database cache for this fetch</span>
<span class="sd">                &gt;&gt;&gt; prices = dataset.fetch(</span>
<span class="sd">                ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">                ...     config=dict(use_database=False)</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                &gt;&gt;&gt; # Disable datetime sorting</span>
<span class="sd">                &gt;&gt;&gt; prices = dataset.fetch(</span>
<span class="sd">                ...     &#39;generators_t.p&#39;,</span>
<span class="sd">                ...     config=dict(auto_sort_datetime_index=False)</span>
<span class="sd">                ... )</span>

<span class="sd">            Override platform-specific options::</span>

<span class="sd">                &gt;&gt;&gt; # Platform configs may have additional options</span>
<span class="sd">                &gt;&gt;&gt; # e.g., a config with timestamp conversion setting</span>
<span class="sd">                &gt;&gt;&gt; data = dataset.fetch(</span>
<span class="sd">                ...     &#39;some_flag&#39;,</span>
<span class="sd">                ...     config=dict(convert_period_enum_to_datetime_index=False)</span>
<span class="sd">                ... )</span>

<span class="sd">            Override study-specific options::</span>

<span class="sd">                &gt;&gt;&gt; # Study-specific configs can add custom behavior</span>
<span class="sd">                &gt;&gt;&gt; # e.g., toggle custom data corrections</span>
<span class="sd">                &gt;&gt;&gt; data = dataset.fetch(</span>
<span class="sd">                ...     &#39;some_flag&#39;,</span>
<span class="sd">                ...     config=dict(apply_custom_correction=False)</span>
<span class="sd">                ... )</span>

<span class="sd">            Using a config object::</span>

<span class="sd">                &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">                &gt;&gt;&gt; custom_config = DatasetConfig(</span>
<span class="sd">                ...     use_database=False,</span>
<span class="sd">                ...     auto_sort_datetime_index=False</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;, config=custom_config)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">effective_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">use_database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">effective_config</span><span class="o">.</span><span class="n">use_database</span>

        <span class="k">if</span> <span class="n">use_database</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">key_is_up_to_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_process_data</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_database</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">processed_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">accepted_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set of all flags accepted by this dataset.</span>

<span class="sd">        This abstract property must be implemented by all concrete dataset classes</span>
<span class="sd">        to define which data flags can be fetched from the dataset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Set of flags that can be used with the fetch() method</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; print(dataset.accepted_flags)</span>
<span class="sd">                {&#39;buses&#39;, &#39;buses_t.marginal_price&#39;, &#39;generators&#39;, &#39;generators_t.p&#39;, ...}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_accepted_flags_containing_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all accepted flags containing a specific substring.</span>

<span class="sd">        Useful for discovering related data flags or filtering flags by category.</span>

<span class="sd">        Args:</span>
<span class="sd">            x: Substring to search for in flag names</span>
<span class="sd">            match_case: If True, performs case-sensitive search. Default is False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Set of accepted flags containing the substring</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; ds = PyPSADataset()</span>
<span class="sd">            &gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;generators&#39;)</span>
<span class="sd">                {&#39;generators&#39;, &#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;, ...}</span>
<span class="sd">            &gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;BUSES&#39;, match_case=True)</span>
<span class="sd">                set()  # Empty because case doesn&#39;t match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">match_case</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)}</span>
        <span class="n">x_lower</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">if</span> <span class="n">x_lower</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flag_is_accepted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean check whether a flag is accepted by the Dataset.</span>

<span class="sd">        This method can be optionally overridden in any child-class</span>
<span class="sd">        in case you want to follow logic instead of the explicit set of accepted_flags.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dotfetch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_DotNotationFetcher</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a dot notation fetcher for intuitive flag access.</span>

<span class="sd">        Returns a helper object that allows accessing nested data flags using</span>
<span class="sd">        Python attribute syntax instead of string-based flags. The fetcher</span>
<span class="sd">        accumulates attribute accesses and converts them to the appropriate</span>
<span class="sd">        flag when called.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _DotNotationFetcher: Helper object enabling chained attribute access</span>

<span class="sd">        Example:</span>
<span class="sd">            Using dot notation instead of string flags::</span>

<span class="sd">                &gt;&gt;&gt; # Traditional string-based fetch</span>
<span class="sd">                &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)</span>

<span class="sd">                &gt;&gt;&gt; # Equivalent dot notation fetch</span>
<span class="sd">                &gt;&gt;&gt; prices = dataset.dotfetch().buses_t.marginal_price()</span>

<span class="sd">                &gt;&gt;&gt; # Multi-level flag access</span>
<span class="sd">                &gt;&gt;&gt; gen_power = dataset.dotfetch().generators_t.p()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_DotNotationFetcher</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flag_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FlagIndexType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the flag index for this dataset.</span>

<span class="sd">        The flag index provides flag mapping, validation, and metadata lookup</span>
<span class="sd">        capabilities. It enables features like dot notation fetching, flag-to-model</span>
<span class="sd">        mapping, and flag categorization.</span>

<span class="sd">        If no flag index was configured, returns an EmptyFlagIndex and logs</span>
<span class="sd">        an informational message when accessed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            FlagIndexType: The configured flag index or EmptyFlagIndex if none set</span>

<span class="sd">        Note:</span>
<span class="sd">            For full flag index functionality (model mapping, flag categorization),</span>
<span class="sd">            ensure a proper flag index is set during dataset initialization.</span>

<span class="sd">        See Also:</span>
<span class="sd">            - [Flag System](../flag.md) - Flag index implementations and usage</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span><span class="p">,</span> <span class="n">EmptyFlagIndex</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="s2">&quot;You&#39;re trying to use functionality of the FlagIndex but didn&#39;t define one. &quot;</span>
                <span class="s2">&quot;The current FlagIndex in use is empty. &quot;</span>
                <span class="s2">&quot;Make sure to set a flag_index in case you want to use full functionality of the flag_index.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">database</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Database</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the caching database for this dataset.</span>

<span class="sd">        The database provides persistent caching for expensive fetch operations.</span>
<span class="sd">        When configured, the fetch() method automatically checks the database</span>
<span class="sd">        before computing data and stores results for future access.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Database | None: The configured database instance, or None if caching</span>
<span class="sd">                is not enabled for this dataset</span>

<span class="sd">        See Also:</span>
<span class="sd">            - Database configuration and caching behavior</span>
<span class="sd">            - Uses database for automatic caching when available (see `fetch()` method)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_kpis_from_definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi_definitions</span><span class="p">:</span> <span class="n">KPIDefinition</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">KPIDefinition</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and add KPIs from one or more KPI definitions.</span>

<span class="sd">        KPI definitions are templates that generate concrete KPI instances</span>
<span class="sd">        based on the dataset&#39;s structure. This method processes definitions</span>
<span class="sd">        and adds the resulting KPIs to the dataset&#39;s KPI collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            kpi_definitions: Single KPIDefinition or list of definitions.</span>
<span class="sd">                Each definition&#39;s generate_kpis() method is called with</span>
<span class="sd">                this dataset to produce KPI instances.</span>

<span class="sd">        Example:</span>
<span class="sd">            Adding KPIs from definitions::</span>

<span class="sd">                &gt;&gt;&gt; from mesqual.kpis.definitions import TotalGenerationKPIDefinition</span>
<span class="sd">                &gt;&gt;&gt; dataset.add_kpis_from_definitions(TotalGenerationKPIDefinition())</span>

<span class="sd">                &gt;&gt;&gt; # Add multiple definitions at once</span>
<span class="sd">                &gt;&gt;&gt; definitions = [</span>
<span class="sd">                ...     TotalGenerationKPIDefinition(),</span>
<span class="sd">                ...     MarginalPriceKPIDefinition(),</span>
<span class="sd">                ... ]</span>
<span class="sd">                &gt;&gt;&gt; dataset.add_kpis_from_definitions(definitions)</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `add_kpi()` - Add a single KPI directly</span>
<span class="sd">            - `add_kpis()` - Add multiple KPI instances</span>
<span class="sd">            - [KPI Definitions](../kpis/definitions/base.md) - Base KPI definition class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.definitions.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPIDefinition</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_definitions</span><span class="p">,</span> <span class="n">KPIDefinition</span><span class="p">):</span>
            <span class="n">kpis</span> <span class="o">=</span> <span class="n">kpi_definitions</span><span class="o">.</span><span class="n">generate_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_kpis</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kpi_def</span> <span class="ow">in</span> <span class="n">kpi_definitions</span><span class="p">:</span>
                <span class="n">kpis</span> <span class="o">=</span> <span class="n">kpi_def</span><span class="o">.</span><span class="n">generate_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_kpis</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpis</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">KPI</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add multiple KPIs to this dataset&#39;s KPI collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            kpis: Iterable of KPI instances, factories, or classes to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">duplicates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="n">kpis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="p">:</span>
                <span class="n">duplicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_kpi</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">duplicates</span><span class="p">:</span>
            <span class="n">_num_duplicates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicates</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">_num_duplicates</span><span class="si">}</span><span class="s1"> duplicates found and not added again or overwritten in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">. (</span><span class="si">{</span><span class="n">duplicates</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">...)&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_kpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi</span><span class="p">:</span> <span class="n">KPI</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a single KPI to this dataset&#39;s KPI collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            kpi: KPI instance, factory, or class to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_kpi_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the KPI collection.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the metadata attributes dictionary for this dataset.</span>

<span class="sd">        Attributes store scenario-level metadata such as configuration parameters,</span>
<span class="sd">        simulation settings, or descriptive labels. These are useful for filtering,</span>
<span class="sd">        grouping, and annotating datasets in collections.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary of attribute key-value pairs. Keys are strings,</span>
<span class="sd">                values are primitive types (bool, int, float, str).</span>

<span class="sd">        Example:</span>
<span class="sd">            Accessing and using attributes::</span>

<span class="sd">                &gt;&gt;&gt; dataset.attributes</span>
<span class="sd">                {&#39;year&#39;: 2030, &#39;scenario_type&#39;: &#39;high_renewable&#39;, &#39;carbon_price&#39;: 50.0}</span>

<span class="sd">                &gt;&gt;&gt; # Filter datasets in a collection by attribute</span>
<span class="sd">                &gt;&gt;&gt; high_re_scenarios = [d for d in collection if d.attributes.get(&#39;scenario_type&#39;) == &#39;high_renewable&#39;]</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `set_attributes()` - Set attribute values</span>
<span class="sd">            - `get_attributes_series()` - Convert attributes to pandas Series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_attributes_series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert dataset attributes to a pandas Series.</span>

<span class="sd">        Creates a Series with attribute names as the index and attribute</span>
<span class="sd">        values as data. The Series name is set to the dataset name, making</span>
<span class="sd">        it suitable for concatenation with other datasets&#39; attribute series.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Series: Series containing attribute values, indexed by attribute</span>
<span class="sd">                names, with the dataset name as the Series name</span>

<span class="sd">        Example:</span>
<span class="sd">            Converting attributes and combining across datasets::</span>

<span class="sd">                &gt;&gt;&gt; dataset.set_attributes(year=2030, carbon_price=50.0)</span>
<span class="sd">                &gt;&gt;&gt; series = dataset.get_attributes_series()</span>
<span class="sd">                &gt;&gt;&gt; series</span>
<span class="sd">                year            2030</span>
<span class="sd">                carbon_price    50.0</span>
<span class="sd">                Name: Scenario_A, dtype: object</span>

<span class="sd">                &gt;&gt;&gt; # Combine attributes from multiple datasets</span>
<span class="sd">                &gt;&gt;&gt; attr_df = pd.concat([d.get_attributes_series() for d in collection], axis=1).T</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `attributes` - Access raw attributes dictionary</span>
<span class="sd">            - `set_attributes()` - Set attribute values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">att_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">att_series</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set one or more metadata attributes on this dataset.</span>

<span class="sd">        Attributes are key-value pairs that store scenario metadata. They must</span>
<span class="sd">        use string keys and primitive values (bool, int, float, str) to ensure</span>
<span class="sd">        serializability and consistent comparison behavior.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: Attribute key-value pairs to set. Keys must be strings,</span>
<span class="sd">                values must be bool, int, float, or str.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If any key is not a string</span>
<span class="sd">            TypeError: If any value is not bool, int, float, or str</span>

<span class="sd">        Example:</span>
<span class="sd">            Setting scenario metadata::</span>

<span class="sd">                &gt;&gt;&gt; dataset.set_attributes(</span>
<span class="sd">                ...     year=2030,</span>
<span class="sd">                ...     scenario_type=&#39;high_renewable&#39;,</span>
<span class="sd">                ...     carbon_price=50.0,</span>
<span class="sd">                ...     includes_nuclear=True</span>
<span class="sd">                ... )</span>

<span class="sd">                &gt;&gt;&gt; # Access the attributes</span>
<span class="sd">                &gt;&gt;&gt; dataset.attributes[&#39;year&#39;]</span>
<span class="sd">                2030</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `attributes` - Access attributes dictionary</span>
<span class="sd">            - `get_attributes_series()` - Convert to pandas Series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Attribute keys must be of type str. Your key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Attribute values must be of type (bool, int, flaot, str). &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;Your value for </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">) is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatasetLinkCollection&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access the parent collection linking this interpreter to sibling interpreters.</span>

<span class="sd">        The parent_dataset provides the bridge between specialized flag interpreters</span>
<span class="sd">        within a single platform dataset or study. It is NOT used to link scenarios</span>
<span class="sd">        together, but rather to enable modular interpreter architectures where each</span>
<span class="sd">        interpreter handles a specific subset of flags and can access flags from</span>
<span class="sd">        sibling interpreters through the shared parent.</span>

<span class="sd">        Architecture Pattern:</span>
<span class="sd">            A typical platform dataset (e.g., PyPSADataset, PlexosDataset) is</span>
<span class="sd">            implemented as a DatasetLinkCollection containing multiple specialized</span>
<span class="sd">            interpreters:</span>

<span class="sd">            - **ModelInterpreter**: Provides static model data (e.g., &#39;generators&#39;, &#39;buses&#39;)</span>
<span class="sd">            - **TimeSeriesInterpreter**: Provides time-series data (e.g., &#39;generators_t.p&#39;)</span>
<span class="sd">            - **ObjectiveInterpreter**: Provides objective function values</span>
<span class="sd">            - **Custom Interpreters**: Study-specific derived or corrected variables</span>

<span class="sd">            Each interpreter is a child dataset within the parent DatasetLinkCollection.</span>
<span class="sd">            Through parent_dataset, any interpreter can fetch flags from siblings without</span>
<span class="sd">            needing direct references or circular dependencies.</span>

<span class="sd">        Why This Pattern:</span>
<span class="sd">            - **Separation of Concerns**: Each interpreter focuses on one data type</span>
<span class="sd">            - **Modularity**: Add/remove/replace interpreters independently</span>
<span class="sd">            - **Dependency Resolution**: Interpreters can depend on each other&#39;s flags</span>
<span class="sd">            - **Study Customization**: Override or extend specific interpreters per study</span>
<span class="sd">            - **Maintainability**: Changes to one interpreter don&#39;t affect others</span>

<span class="sd">        Returns:</span>
<span class="sd">            DatasetLinkCollection: The parent collection that orchestrates flag</span>
<span class="sd">                routing between this interpreter and its siblings</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If accessed before the parent has been assigned (typically</span>
<span class="sd">                happens if an interpreter is used standalone instead of within a</span>
<span class="sd">                DatasetLinkCollection)</span>

<span class="sd">        Example:</span>
<span class="sd">            Custom interpreter combining flags from sibling interpreters:</span>

<span class="sd">                &gt;&gt;&gt; # Study-specific interpreter for renewable generation per bidding zone</span>
<span class="sd">                &gt;&gt;&gt; class RESGenerationPerBZInterpreter(PlatformBaseInterpreterDataset):</span>
<span class="sd">                ...     @property</span>
<span class="sd">                ...     def accepted_flags(self):</span>
<span class="sd">                ...         return {&#39;generators_t.res_generation_per_bz&#39;}</span>
<span class="sd">                ...</span>
<span class="sd">                ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">                ...         # Fetch time series from TimeSeriesInterpreter sibling</span>
<span class="sd">                ...         generation = self.parent_dataset.fetch(&#39;generators_t.p&#39;)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Fetch model data from ModelInterpreter sibling</span>
<span class="sd">                ...         gen_model = self.parent_dataset.fetch(&#39;generators.model&#39;)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Filter to RES generators and aggregate by bidding zone</span>
<span class="sd">                ...         res_gens = gen_model[gen_model[&#39;carrier&#39;].isin([&#39;solar&#39;, &#39;wind&#39;])]</span>
<span class="sd">                ...         res_generation = generation[res_gens.index]</span>
<span class="sd">                ...         return res_generation.groupby(gen_model[&#39;bidding_zone&#39;], axis=1).sum()</span>

<span class="sd">            Accessing specific sibling interpreter by type:</span>

<span class="sd">                &gt;&gt;&gt; class SomeCustomPTDFMatrixFormat(PlexosImporterBase):</span>
<span class="sd">                ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">                ...         # Get specific sibling interpreter</span>
<span class="sd">                ...         ptdf_ds = self.parent_dataset.get_dataset_by_type(</span>
<span class="sd">                ...             PlexosPTDFInterpreter</span>
<span class="sd">                ...         )</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Or fetch through parent (automatically routes to correct sibling)</span>
<span class="sd">                ...         headers = self.parent_dataset.fetch(&#39;PTDF.Headers&#39;)</span>
<span class="sd">                ...         factors = self.parent_dataset.fetch(&#39;PTDF.Factors&#39;)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Process and return derived flag</span>
<span class="sd">                ...         return self._custom_ptdf_process(headers, factors)</span>

<span class="sd">            Study-specific correction of platform variables:</span>

<span class="sd">                &gt;&gt;&gt; class LineFlows(MyStudyVariables):</span>
<span class="sd">                ...     &#39;&#39;&#39;Replaces specific flows with external data.&#39;&#39;&#39;</span>
<span class="sd">                ...</span>
<span class="sd">                ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">                ...         # Get reference dataset (sibling interpreter) for this flag</span>
<span class="sd">                ...         reference_ds = self._get_reference_dataset_for_flag(flag)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Fetch original data from sibling</span>
<span class="sd">                ...         df = reference_ds.fetch(flag, config, **kwargs)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         # Apply study-specific corrections</span>
<span class="sd">                ...         if self.parent_dataset.attributes[&#39;manual_line_flow_correction&#39;]:</span>
<span class="sd">                ...             df = self._apply_historical_corrections(df)</span>
<span class="sd">                ...</span>
<span class="sd">                ...         return df</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `DatasetLinkCollection` - Parent collection class that orchestrates routing</span>
<span class="sd">            - `get_dataset_by_type()` - Method to access specific sibling by type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parent dataset called without / before assignment.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_dataset</span>

    <span class="nd">@parent_dataset</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">:</span> <span class="s1">&#39;DatasetLinkCollection&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the parent collection for this dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            parent_dataset: The DatasetLinkCollection that will contain this dataset</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If parent_dataset is not a DatasetLinkCollection instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetLinkCollection</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent_dataset</span><span class="p">,</span> <span class="n">DatasetLinkCollection</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parent parent_dataset must be of type </span><span class="si">{</span><span class="n">DatasetLinkCollection</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_dataset</span> <span class="o">=</span> <span class="n">parent_dataset</span>

    <span class="nd">@flag_must_be_accepted</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_flags_for_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the set of flags required to compute a given flag.</span>

<span class="sd">        For derived or computed flags, this method returns the set of source</span>
<span class="sd">        flags that must be available to produce the requested data. This is</span>
<span class="sd">        useful for understanding data dependencies and ensuring prerequisite</span>
<span class="sd">        data exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: The flag to check requirements for. Must be in accepted_flags.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set[FlagType]: Set of flags that are required to compute the given flag.</span>
<span class="sd">                Returns an empty set if the flag has no dependencies.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the flag is not accepted by this dataset</span>

<span class="sd">        Example:</span>
<span class="sd">            Checking data dependencies::</span>

<span class="sd">                &gt;&gt;&gt; # A derived flag might depend on multiple source flags</span>
<span class="sd">                &gt;&gt;&gt; deps = dataset.required_flags_for_flag(&#39;total_generation&#39;)</span>
<span class="sd">                &gt;&gt;&gt; deps</span>
<span class="sd">                {&#39;generators_t.p&#39;, &#39;generators&#39;}</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `_required_flags_for_flag()` - Abstract method to implement</span>
<span class="sd">            - `flag_is_accepted()` - Check if a flag is valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_flags_for_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_required_flags_for_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract method to define flag dependencies.</span>

<span class="sd">        Subclasses must implement this method to specify which flags are</span>
<span class="sd">        required to compute a given flag. This enables dependency tracking</span>
<span class="sd">        and validation of data availability.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: The flag to get requirements for</span>

<span class="sd">        Returns:</span>
<span class="sd">            set[FlagType]: Set of prerequisite flags. Return empty set for</span>
<span class="sd">                flags with no dependencies.</span>

<span class="sd">        Note:</span>
<span class="sd">            This is a protected method called by required_flags_for_flag().</span>
<span class="sd">            The public method handles flag validation before calling this.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_post_process_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply standard post-processing to fetched data.</span>

<span class="sd">        Performs configuration-driven data cleaning and normalization after</span>
<span class="sd">        the raw data is fetched. This includes removing duplicate indices</span>
<span class="sd">        and sorting datetime indices.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Raw data from _fetch()</span>
<span class="sd">            flag: The flag that was fetched (for logging)</span>
<span class="sd">            config: Effective configuration controlling post-processing behavior</span>

<span class="sd">        Returns:</span>
<span class="sd">            Post-processed data with duplicates removed and/or sorted as configured</span>

<span class="sd">        Note:</span>
<span class="sd">            This method is called automatically by fetch(). Subclasses can</span>
<span class="sd">            override to add custom post-processing while calling super().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">remove_duplicate_indices</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;For some reason your data-set </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> returns an object with duplicate indices for flag </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;We manually remove duplicate indices. Please make sure your data importer / converter is set up &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;appropriately and that your raw data does not contain duplicate indices. </span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;We will keep the first element of every duplicated index.&#39;</span>
            <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">auto_sort_datetime_index</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetConfigType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the effective configuration for a fetch operation.</span>

<span class="sd">        Resolves the final configuration by merging the provided config override</span>
<span class="sd">        with the dataset&#39;s instance config (which already includes class-level</span>
<span class="sd">        and base defaults via DatasetConfigManager).</span>

<span class="sd">        Args:</span>
<span class="sd">            config: Optional override configuration. Can be:</span>
<span class="sd">                - None: Use instance config as-is</span>
<span class="sd">                - dict: Create temp config from dict and merge</span>
<span class="sd">                - DatasetConfig: Merge directly with instance config</span>

<span class="sd">        Returns:</span>
<span class="sd">            The fully resolved configuration for the fetch operation.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If config is neither None, dict, nor DatasetConfig.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance_config</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">temp_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_type</span><span class="p">()()</span>
            <span class="n">temp_config</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance_config</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">temp_config</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfig</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">DatasetConfig</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance_config</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config must be dict or </span><span class="si">{</span><span class="n">DatasetConfig</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract method implementing the actual data retrieval logic.</span>

<span class="sd">        Subclasses must implement this method to define how data is retrieved</span>
<span class="sd">        for each flag. This is the core data access method that fetch() calls</span>
<span class="sd">        after configuration resolution and before post-processing.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: The validated flag to fetch data for</span>
<span class="sd">            effective_config: The fully resolved configuration for this operation</span>
<span class="sd">            **kwargs: Additional implementation-specific arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame or Series containing the requested data. The returned</span>
<span class="sd">            data will be post-processed by _post_process_data() before being</span>
<span class="sd">            returned to the caller.</span>

<span class="sd">        Note:</span>
<span class="sd">            - This method should not perform flag validation (handled by fetch())</span>
<span class="sd">            - This method should not apply post-processing (handled separately)</span>
<span class="sd">            - This method should not handle caching (handled by fetch())</span>

<span class="sd">        Example:</span>
<span class="sd">            Implementing in a subclass::</span>

<span class="sd">                def _fetch(self, flag, effective_config, **kwargs):</span>
<span class="sd">                    if flag == &#39;generators&#39;:</span>
<span class="sd">                        return self.network.generators</span>
<span class="sd">                    elif flag == &#39;generators_t.p&#39;:</span>
<span class="sd">                        return self.network.generators_t.p</span>
<span class="sd">                    # ... handle other flags</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_multiple_flags_and_concat</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FlagType</span><span class="p">],</span>
            <span class="n">concat_axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">concat_level_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span>
            <span class="n">concat_level_at_top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch multiple flags and concatenate results into a single DataFrame.</span>

<span class="sd">        Convenience method for retrieving data from multiple flags and combining</span>
<span class="sd">        them into a single DataFrame with a MultiIndex. Useful for comparative</span>
<span class="sd">        analysis of multiple variables or creating wide-format data structures.</span>

<span class="sd">        Args:</span>
<span class="sd">            flags: Iterable of flags to fetch and concatenate</span>
<span class="sd">            concat_axis: Axis along which to concatenate (0=rows, 1=columns).</span>
<span class="sd">                Default is 1 (columns).</span>
<span class="sd">            concat_level_name: Name for the new MultiIndex level identifying</span>
<span class="sd">                the source flag. Default is &#39;variable&#39;.</span>
<span class="sd">            concat_level_at_top: If True, the flag level is the outermost level</span>
<span class="sd">                in the MultiIndex. If False, it&#39;s moved to the innermost level.</span>
<span class="sd">                Default is True.</span>
<span class="sd">            config: Optional configuration override (see fetch() for details)</span>
<span class="sd">            **kwargs: Additional arguments passed to each fetch() call</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with concatenated data and a MultiIndex identifying the</span>
<span class="sd">            source flag for each section</span>

<span class="sd">        Example:</span>
<span class="sd">            Fetching and comparing multiple variables::</span>

<span class="sd">                &gt;&gt;&gt; # Fetch power output and efficiency for generators</span>
<span class="sd">                &gt;&gt;&gt; combined = dataset.fetch_multiple_flags_and_concat(</span>
<span class="sd">                ...     flags=[&#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;],</span>
<span class="sd">                ...     concat_level_name=&#39;metric&#39;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; # Result has MultiIndex columns: (metric, generator_name)</span>

<span class="sd">                &gt;&gt;&gt; # Row-wise concatenation</span>
<span class="sd">                &gt;&gt;&gt; stacked = dataset.fetch_multiple_flags_and_concat(</span>
<span class="sd">                ...     flags=[&#39;bus_A_prices&#39;, &#39;bus_B_prices&#39;],</span>
<span class="sd">                ...     concat_axis=0,</span>
<span class="sd">                ...     concat_level_name=&#39;bus&#39;</span>
<span class="sd">                ... )</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `fetch()` - Single flag data retrieval</span>
<span class="sd">            - `fetch_filter_groupby_agg()` - Fetch with filtering and aggregation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="n">dfs</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">concat_axis</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">concat_level_name</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">concat_level_at_top</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">nlevels</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_filter_groupby_agg</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">model_filter_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">prop_groupby</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">prop_groupby_agg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch data with model-based filtering, grouping, and aggregation.</span>

<span class="sd">        Provides a powerful one-line method for common data analysis patterns:</span>
<span class="sd">        filter time series by model properties, group by categories, and</span>
<span class="sd">        aggregate results. Requires a flag index with model mappings.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: Data flag to fetch (must have a linked model flag)</span>
<span class="sd">            model_filter_query: Pandas query string to filter based on model</span>
<span class="sd">                properties. Applied to the linked model DataFrame.</span>
<span class="sd">                Example: &quot;carrier == &#39;solar&#39;&quot; or &quot;p_nom &gt; 100&quot;</span>
<span class="sd">            prop_groupby: Model property or list of properties to group by.</span>
<span class="sd">                Adds these as MultiIndex levels and groups the data.</span>
<span class="sd">                Example: &#39;carrier&#39; or [&#39;carrier&#39;, &#39;bus&#39;]</span>
<span class="sd">            prop_groupby_agg: Aggregation function to apply after grouping.</span>
<span class="sd">                Standard pandas aggregation strings like &#39;sum&#39;, &#39;mean&#39;, &#39;max&#39;.</span>
<span class="sd">                Only used if prop_groupby is specified.</span>
<span class="sd">            config: Optional configuration override (see fetch() for details)</span>
<span class="sd">            **kwargs: Additional arguments passed to fetch()</span>

<span class="sd">        Returns:</span>
<span class="sd">            Filtered and/or aggregated data. If prop_groupby is specified without</span>
<span class="sd">            prop_groupby_agg, returns a DataFrameGroupBy object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the flag has no linked model flag in the flag index</span>

<span class="sd">        Example:</span>
<span class="sd">            Common analysis patterns::</span>

<span class="sd">                &gt;&gt;&gt; # Filter generators to only solar, sum by carrier</span>
<span class="sd">                &gt;&gt;&gt; solar_gen = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">                ...     &#39;generators_t.p&#39;,</span>
<span class="sd">                ...     model_filter_query=&quot;carrier == &#39;solar&#39;&quot;,</span>
<span class="sd">                ...     prop_groupby=&#39;carrier&#39;,</span>
<span class="sd">                ...     prop_groupby_agg=&#39;sum&#39;</span>
<span class="sd">                ... )</span>

<span class="sd">                &gt;&gt;&gt; # Group all generation by carrier and bus</span>
<span class="sd">                &gt;&gt;&gt; by_carrier_bus = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">                ...     &#39;generators_t.p&#39;,</span>
<span class="sd">                ...     prop_groupby=[&#39;carrier&#39;, &#39;bus&#39;],</span>
<span class="sd">                ...     prop_groupby_agg=&#39;sum&#39;</span>
<span class="sd">                ... )</span>

<span class="sd">                &gt;&gt;&gt; # Filter to large generators only</span>
<span class="sd">                &gt;&gt;&gt; large_gens = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">                ...     &#39;generators_t.p&#39;,</span>
<span class="sd">                ...     model_filter_query=&quot;p_nom &gt;= 500&quot;</span>
<span class="sd">                ... )</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `fetch()` - Basic data retrieval</span>
<span class="sd">            - [Pandas Utils](../utils/pandas_utils/index.md) - Underlying filter/group utilities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_index</span><span class="o">.</span><span class="n">get_linked_model_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model_flag</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FlagIndex could not successfully map flag </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s1"> to a model flag.&#39;</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">pandas_utils</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetCollection</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DatasetCollection</span><span class="p">):</span>
            <span class="c1"># TODO: implement MultiIndex capabilities into filter_by_model_query / prepend_model_prop_levels, then fetch_merged is not needed</span>
            <span class="n">model_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_merged</span><span class="p">(</span><span class="n">model_flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">model_flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">model_filter_query</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pandas_utils</span><span class="o">.</span><span class="n">filter_by_model_query</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model_df</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">model_filter_query</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">prop_groupby</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_groupby</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">prop_groupby</span> <span class="o">=</span> <span class="p">[</span><span class="n">prop_groupby</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pandas_utils</span><span class="o">.</span><span class="n">prepend_model_prop_levels</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model_df</span><span class="p">,</span> <span class="o">*</span><span class="n">prop_groupby</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">prop_groupby</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prop_groupby_agg</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">prop_groupby_agg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop_groupby_agg</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You provided a prop_groupby_agg operation, but didn&#39;t provide prop_groupby. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;No aggregation performed.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_flag_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the flag type class for this dataset type.</span>

<span class="sd">        Returns the type used for data flags in this dataset class. Subclasses</span>
<span class="sd">        can override to specify a custom flag type for type checking and</span>
<span class="sd">        validation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Type[FlagType]: The flag type class (default: FlagTypeProtocol)</span>

<span class="sd">        Note:</span>
<span class="sd">            Override in subclasses that use custom flag types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.flag.flag</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlagTypeProtocol</span>
        <span class="k">return</span> <span class="n">FlagTypeProtocol</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_flag_index_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">FlagIndexType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the flag index type class for this dataset type.</span>

<span class="sd">        Returns the type used for the flag index in this dataset class.</span>
<span class="sd">        Subclasses can override to specify a custom flag index implementation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Type[FlagIndexType]: The flag index type class (default: FlagIndex)</span>

<span class="sd">        Note:</span>
<span class="sd">            Override in subclasses that use platform-specific flag indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.flag.flag_index</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlagIndex</span>
        <span class="k">return</span> <span class="n">FlagIndex</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_config_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetConfigType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the configuration type class for this dataset type.</span>

<span class="sd">        Returns the DatasetConfig subclass used by this dataset. Platform</span>
<span class="sd">        interfaces typically override this to return their extended config</span>
<span class="sd">        class with platform-specific options.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Type[DatasetConfigType]: The config type class (default: DatasetConfig)</span>

<span class="sd">        Example:</span>
<span class="sd">            Creating a config instance for this dataset type::</span>

<span class="sd">                &gt;&gt;&gt; ConfigClass = MyDataset.get_config_type()</span>
<span class="sd">                &gt;&gt;&gt; config = ConfigClass(use_database=True)</span>

<span class="sd">        Note:</span>
<span class="sd">            Override in platform dataset subclasses to return platform-specific</span>
<span class="sd">            config types with additional options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfig</span>
        <span class="k">return</span> <span class="n">DatasetConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">instance_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetConfigType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the effective configuration for this dataset instance.</span>

<span class="sd">        Computes the merged configuration by combining:</span>
<span class="sd">        1. Base config defaults</span>
<span class="sd">        2. Class-level config (set via set_class_config)</span>
<span class="sd">        3. Instance-level config (passed to __init__ or set via set_instance_config)</span>

<span class="sd">        Later settings override earlier ones. This is the configuration used</span>
<span class="sd">        by fetch() unless overridden by a fetch-time config parameter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DatasetConfigType: The fully resolved configuration for this instance</span>

<span class="sd">        Example:</span>
<span class="sd">            Inspecting current configuration::</span>

<span class="sd">                &gt;&gt;&gt; config = dataset.instance_config</span>
<span class="sd">                &gt;&gt;&gt; print(config.use_database)</span>
<span class="sd">                True</span>
<span class="sd">                &gt;&gt;&gt; print(config.auto_sort_datetime_index)</span>
<span class="sd">                True</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `set_instance_config()` - Replace instance configuration</span>
<span class="sd">            - `set_class_config()` - Set class-level defaults</span>
<span class="sd">            - DatasetConfigManager - Configuration management system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfigManager</span>
        <span class="k">return</span> <span class="n">DatasetConfigManager</span><span class="o">.</span><span class="n">get_effective_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_instance_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the instance-level configuration for this dataset.</span>

<span class="sd">        Sets the configuration that will be merged with class-level defaults</span>
<span class="sd">        to produce the effective configuration used by fetch().</span>

<span class="sd">        Args:</span>
<span class="sd">            config: New configuration object to use for this instance</span>

<span class="sd">        Example:</span>
<span class="sd">            Setting a custom configuration::</span>

<span class="sd">                &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">                &gt;&gt;&gt; config = DatasetConfig(use_database=False, auto_sort_datetime_index=False)</span>
<span class="sd">                &gt;&gt;&gt; dataset.set_instance_config(config)</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `instance_config` - Get the effective configuration</span>
<span class="sd">            - `set_instance_config_kwargs()` - Update individual settings</span>
<span class="sd">            - `set_class_config()` - Set class-level defaults</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_instance_config_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update individual configuration settings on this instance.</span>

<span class="sd">        Modifies specific attributes of the existing instance configuration</span>
<span class="sd">        without replacing the entire config object. Useful for tweaking</span>
<span class="sd">        individual settings.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: Configuration attribute names and values to set</span>

<span class="sd">        Example:</span>
<span class="sd">            Adjusting specific settings::</span>

<span class="sd">                &gt;&gt;&gt; dataset.set_instance_config_kwargs(</span>
<span class="sd">                ...     use_database=True,</span>
<span class="sd">                ...     auto_sort_datetime_index=False</span>
<span class="sd">                ... )</span>

<span class="sd">        Warning:</span>
<span class="sd">            Raises AttributeError if the config attribute doesn&#39;t exist.</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `set_instance_config()` - Replace entire configuration</span>
<span class="sd">            - `instance_config` - Get the effective configuration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_class_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the class-level configuration for all instances of this dataset type.</span>

<span class="sd">        Class-level configuration serves as the default for all instances of</span>
<span class="sd">        this class. Instance-level configuration (set via set_instance_config)</span>
<span class="sd">        can override these defaults.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: Configuration object to use as class-level defaults</span>

<span class="sd">        Example:</span>
<span class="sd">            Setting defaults for all instances::</span>

<span class="sd">                &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">                &gt;&gt;&gt; config = DatasetConfig(use_database=True)</span>
<span class="sd">                &gt;&gt;&gt; MyDataset.set_class_config(config)</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                &gt;&gt;&gt; # All new instances will use database by default</span>
<span class="sd">                &gt;&gt;&gt; ds1 = MyDataset()  # uses database</span>
<span class="sd">                &gt;&gt;&gt; ds2 = MyDataset()  # uses database</span>

<span class="sd">        Note:</span>
<span class="sd">            This affects all instances of the class, including existing ones</span>
<span class="sd">            that haven&#39;t overridden the setting at instance level.</span>

<span class="sd">        See Also:</span>
<span class="sd">            - `set_instance_config()` - Override for specific instances</span>
<span class="sd">            - DatasetConfigManager - Configuration management system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfigManager</span>
        <span class="n">DatasetConfigManager</span><span class="o">.</span><span class="n">set_class_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.accepted_flags" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">accepted_flags</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.accepted_flags" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">accepted_flags</span><span class="p">:</span> <span class="n"><span title="set">set</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set of all flags accepted by this dataset.</p>
<p>This abstract property must be implemented by all concrete dataset classes
to define which data flags can be fetched from the dataset.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="set">set</span>[<span title="mesqual.typevars.FlagType">FlagType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set of flags that can be used with the fetch() method</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; print(dataset.accepted_flags)
    {&#39;buses&#39;, &#39;buses_t.marginal_price&#39;, &#39;generators&#39;, &#39;generators_t.p&#39;, ...}
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.flag_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">flag_index</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.flag_index" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">flag_index</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagIndexType">FlagIndexType</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Access the flag index for this dataset.</p>
<p>The flag index provides flag mapping, validation, and metadata lookup
capabilities. It enables features like dot notation fetching, flag-to-model
mapping, and flag categorization.</p>
<p>If no flag index was configured, returns an EmptyFlagIndex and logs
an informational message when accessed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FlagIndexType</code></td>            <td>
                  <code><span title="mesqual.typevars.FlagIndexType">FlagIndexType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configured flag index or EmptyFlagIndex if none set</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>For full flag index functionality (model mapping, flag categorization),
ensure a proper flag index is set during dataset initialization.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a href="../flag.md">Flag System</a> - Flag index implementations and usage</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.database" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">database</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.database" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">database</span><span class="p">:</span> <span class="n"><span title="mesqual.databases.database.Database">Database</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Access the caching database for this dataset.</p>
<p>The database provides persistent caching for expensive fetch operations.
When configured, the fetch() method automatically checks the database
before computing data and stores results for future access.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="mesqual.databases.database.Database">Database</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database | None: The configured database instance, or None if caching
is not enabled for this dataset</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>Database configuration and caching behavior</li>
<li>Uses database for automatic caching when available (see <code>fetch()</code> method)</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.attributes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">attributes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.attributes" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">attributes</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Access the metadata attributes dictionary for this dataset.</p>
<p>Attributes store scenario-level metadata such as configuration parameters,
simulation settings, or descriptive labels. These are useful for filtering,
grouping, and annotating datasets in collections.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of attribute key-value pairs. Keys are strings,
values are primitive types (bool, int, float, str).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Accessing and using attributes::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; dataset.attributes
{&#39;year&#39;: 2030, &#39;scenario_type&#39;: &#39;high_renewable&#39;, &#39;carbon_price&#39;: 50.0}

&gt;&gt;&gt; # Filter datasets in a collection by attribute
&gt;&gt;&gt; high_re_scenarios = [d for d in collection if d.attributes.get(&#39;scenario_type&#39;) == &#39;high_renewable&#39;]
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>set_attributes()</code> - Set attribute values</li>
<li><code>get_attributes_series()</code> - Convert attributes to pandas Series</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.parent_dataset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">parent_dataset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.parent_dataset" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parent_dataset</span><span class="p">:</span> <span class="s1">&#39;DatasetLinkCollection&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Access the parent collection linking this interpreter to sibling interpreters.</p>
<p>The parent_dataset provides the bridge between specialized flag interpreters
within a single platform dataset or study. It is NOT used to link scenarios
together, but rather to enable modular interpreter architectures where each
interpreter handles a specific subset of flags and can access flags from
sibling interpreters through the shared parent.</p>


<details class="architecture-pattern" open>
  <summary>Architecture Pattern</summary>
  <p>A typical platform dataset (e.g., PyPSADataset, PlexosDataset) is
implemented as a DatasetLinkCollection containing multiple specialized
interpreters:</p>
<ul>
<li><strong>ModelInterpreter</strong>: Provides static model data (e.g., 'generators', 'buses')</li>
<li><strong>TimeSeriesInterpreter</strong>: Provides time-series data (e.g., 'generators_t.p')</li>
<li><strong>ObjectiveInterpreter</strong>: Provides objective function values</li>
<li><strong>Custom Interpreters</strong>: Study-specific derived or corrected variables</li>
</ul>
<p>Each interpreter is a child dataset within the parent DatasetLinkCollection.
Through parent_dataset, any interpreter can fetch flags from siblings without
needing direct references or circular dependencies.</p>
</details>

<details class="why-this-pattern" open>
  <summary>Why This Pattern</summary>
  <ul>
<li><strong>Separation of Concerns</strong>: Each interpreter focuses on one data type</li>
<li><strong>Modularity</strong>: Add/remove/replace interpreters independently</li>
<li><strong>Dependency Resolution</strong>: Interpreters can depend on each other's flags</li>
<li><strong>Study Customization</strong>: Override or extend specific interpreters per study</li>
<li><strong>Maintainability</strong>: Changes to one interpreter don't affect others</li>
</ul>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DatasetLinkCollection</code></td>            <td>
                  <code>&#39;DatasetLinkCollection&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parent collection that orchestrates flag
routing between this interpreter and its siblings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If accessed before the parent has been assigned (typically
happens if an interpreter is used standalone instead of within a
DatasetLinkCollection)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Custom interpreter combining flags from sibling interpreters:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Study-specific interpreter for renewable generation per bidding zone
&gt;&gt;&gt; class RESGenerationPerBZInterpreter(PlatformBaseInterpreterDataset):
...     @property
...     def accepted_flags(self):
...         return {&#39;generators_t.res_generation_per_bz&#39;}
...
...     def _fetch(self, flag, config, **kwargs):
...         # Fetch time series from TimeSeriesInterpreter sibling
...         generation = self.parent_dataset.fetch(&#39;generators_t.p&#39;)
...
...         # Fetch model data from ModelInterpreter sibling
...         gen_model = self.parent_dataset.fetch(&#39;generators.model&#39;)
...
...         # Filter to RES generators and aggregate by bidding zone
...         res_gens = gen_model[gen_model[&#39;carrier&#39;].isin([&#39;solar&#39;, &#39;wind&#39;])]
...         res_generation = generation[res_gens.index]
...         return res_generation.groupby(gen_model[&#39;bidding_zone&#39;], axis=1).sum()
</code></pre></div>
<p>Accessing specific sibling interpreter by type:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class SomeCustomPTDFMatrixFormat(PlexosImporterBase):
...     def _fetch(self, flag, config, **kwargs):
...         # Get specific sibling interpreter
...         ptdf_ds = self.parent_dataset.get_dataset_by_type(
...             PlexosPTDFInterpreter
...         )
...
...         # Or fetch through parent (automatically routes to correct sibling)
...         headers = self.parent_dataset.fetch(&#39;PTDF.Headers&#39;)
...         factors = self.parent_dataset.fetch(&#39;PTDF.Factors&#39;)
...
...         # Process and return derived flag
...         return self._custom_ptdf_process(headers, factors)
</code></pre></div>
<p>Study-specific correction of platform variables:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class LineFlows(MyStudyVariables):
...     &#39;&#39;&#39;Replaces specific flows with external data.&#39;&#39;&#39;
...
...     def _fetch(self, flag, config, **kwargs):
...         # Get reference dataset (sibling interpreter) for this flag
...         reference_ds = self._get_reference_dataset_for_flag(flag)
...
...         # Fetch original data from sibling
...         df = reference_ds.fetch(flag, config, **kwargs)
...
...         # Apply study-specific corrections
...         if self.parent_dataset.attributes[&#39;manual_line_flow_correction&#39;]:
...             df = self._apply_historical_corrections(df)
...
...         return df
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>DatasetLinkCollection</code> - Parent collection class that orchestrates routing</li>
<li><code>get_dataset_by_type()</code> - Method to access specific sibling by type</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="mesqual.datasets.Dataset.instance_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">instance_config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.instance_config" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">instance_config</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the effective configuration for this dataset instance.</p>
<p>Computes the merged configuration by combining:
1. Base config defaults
2. Class-level config (set via set_class_config)
3. Instance-level config (passed to <strong>init</strong> or set via set_instance_config)</p>
<p>Later settings override earlier ones. This is the configuration used
by fetch() unless overridden by a fetch-time config parameter.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DatasetConfigType</code></td>            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fully resolved configuration for this instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Inspecting current configuration::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; config = dataset.instance_config
&gt;&gt;&gt; print(config.use_database)
True
&gt;&gt;&gt; print(config.auto_sort_datetime_index)
True
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>set_instance_config()</code> - Replace instance configuration</li>
<li><code>set_class_config()</code> - Set class-level defaults</li>
<li>DatasetConfigManager - Configuration management system</li>
</ul>
</details>
    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#mesqual.datasets.Dataset.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            Dataset (mesqual.datasets.dataset.Dataset)" href="#mesqual.datasets.Dataset">Dataset</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">flag_index</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagIndexType">FlagIndexType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">attributes</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="n"><span title="mesqual.databases.database.Database">Database</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize a new Dataset instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable identifier. If None, auto-generates from class name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent_dataset</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            Dataset (mesqual.datasets.dataset.Dataset)" href="#mesqual.datasets.Dataset">Dataset</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional parent dataset for hierarchical relationships</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flag_index</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.FlagIndexType">FlagIndexType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index for mapping and validating data flags</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attributes</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of metadata attributes for the dataset</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="mesqual.databases.database.Database">Database</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional database for caching expensive computations</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object controlling dataset behavior</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndexType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new Dataset instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Human-readable identifier. If None, auto-generates from class name</span>
<span class="sd">        parent_dataset: Optional parent dataset for hierarchical relationships</span>
<span class="sd">        flag_index: Index for mapping and validating data flags</span>
<span class="sd">        attributes: Dictionary of metadata attributes for the dataset</span>
<span class="sd">        database: Optional database for caching expensive computations</span>
<span class="sd">        config: Configuration object controlling dataset behavior</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span> <span class="o">=</span> <span class="n">flag_index</span> <span class="ow">or</span> <span class="n">EmptyFlagIndex</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parent_dataset</span> <span class="o">=</span> <span class="n">parent_dataset</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">attributes</span> <span class="ow">or</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_database</span> <span class="o">=</span> <span class="n">database</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="p">:</span> <span class="n">KPICollection</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.fetch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fetch</span>


<a href="#mesqual.datasets.Dataset.fetch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span> <span class="o">|</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fetch data associated with a specific flag.</p>
<p>This is the primary method for data access in MESQUAL datasets. It provides
a unified interface for retrieving data regardless of the underlying source
or dataset type. The method includes automatic caching, post-processing,
and configuration management.</p>
<p>Configuration Override Behavior:</p>
<div class="highlight"><pre><span></span><code>The ``config`` parameter allows fetch-time overrides of dataset behavior.
These overrides are merged with the dataset&#39;s effective configuration
(which combines class-level and instance-level settings). Only non-None
values in the override will replace the existing settings.
</code></pre></div>
<p>The configuration resolution hierarchy (later overrides earlier):</p>
<div class="highlight"><pre><span></span><code>1. Base config defaults
2. Class config (via DatasetConfigManager)
3. Instance config (passed to Dataset.__init__)
4. **Fetch-time config (this parameter)**
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flag</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.FlagType">FlagType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data identifier flag (must be in accepted_flags)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional configuration to override dataset defaults.
Can be either:</p>
<ul>
<li>
<p><strong>dict</strong>: Quick way to override specific settings. Keys must
  match config attribute names (e.g., <code>use_database</code>,
  <code>auto_sort_datetime_index</code>). Platform-specific options
  are also supported if the dataset uses an extended config.</p>
</li>
<li>
<p><strong>DatasetConfig instance</strong>: Full config object for type safety.
  Must be compatible with the dataset's config type.</p>
</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to the underlying
data fetching implementation</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame or Series containing the requested data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the flag is not accepted by this dataset</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)
</code></pre></div>
<p>Override base config options with a dict::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Skip database cache for this fetch
&gt;&gt;&gt; prices = dataset.fetch(
...     &#39;buses_t.marginal_price&#39;,
...     config=dict(use_database=False)
... )
&gt;&gt;&gt;
&gt;&gt;&gt; # Disable datetime sorting
&gt;&gt;&gt; prices = dataset.fetch(
...     &#39;generators_t.p&#39;,
...     config=dict(auto_sort_datetime_index=False)
... )
</code></pre></div>
<p>Override platform-specific options::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Platform configs may have additional options
&gt;&gt;&gt; # e.g., a config with timestamp conversion setting
&gt;&gt;&gt; data = dataset.fetch(
...     &#39;some_flag&#39;,
...     config=dict(convert_period_enum_to_datetime_index=False)
... )
</code></pre></div>
<p>Override study-specific options::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Study-specific configs can add custom behavior
&gt;&gt;&gt; # e.g., toggle custom data corrections
&gt;&gt;&gt; data = dataset.fetch(
...     &#39;some_flag&#39;,
...     config=dict(apply_custom_correction=False)
... )
</code></pre></div>
<p>Using a config object::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mesqual.datasets import DatasetConfig
&gt;&gt;&gt; custom_config = DatasetConfig(
...     use_database=False,
...     auto_sort_datetime_index=False
... )
&gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;, config=custom_config)
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@flag_must_be_accepted</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch data associated with a specific flag.</span>

<span class="sd">    This is the primary method for data access in MESQUAL datasets. It provides</span>
<span class="sd">    a unified interface for retrieving data regardless of the underlying source</span>
<span class="sd">    or dataset type. The method includes automatic caching, post-processing,</span>
<span class="sd">    and configuration management.</span>

<span class="sd">    Configuration Override Behavior:</span>

<span class="sd">        The ``config`` parameter allows fetch-time overrides of dataset behavior.</span>
<span class="sd">        These overrides are merged with the dataset&#39;s effective configuration</span>
<span class="sd">        (which combines class-level and instance-level settings). Only non-None</span>
<span class="sd">        values in the override will replace the existing settings.</span>

<span class="sd">    The configuration resolution hierarchy (later overrides earlier):</span>

<span class="sd">        1. Base config defaults</span>
<span class="sd">        2. Class config (via DatasetConfigManager)</span>
<span class="sd">        3. Instance config (passed to Dataset.__init__)</span>
<span class="sd">        4. **Fetch-time config (this parameter)**</span>

<span class="sd">    Args:</span>
<span class="sd">        flag: Data identifier flag (must be in accepted_flags)</span>
<span class="sd">        config: Optional configuration to override dataset defaults.</span>
<span class="sd">            Can be either:</span>

<span class="sd">            - **dict**: Quick way to override specific settings. Keys must</span>
<span class="sd">              match config attribute names (e.g., ``use_database``,</span>
<span class="sd">              ``auto_sort_datetime_index``). Platform-specific options</span>
<span class="sd">              are also supported if the dataset uses an extended config.</span>

<span class="sd">            - **DatasetConfig instance**: Full config object for type safety.</span>
<span class="sd">              Must be compatible with the dataset&#39;s config type.</span>

<span class="sd">        **kwargs: Additional keyword arguments passed to the underlying</span>
<span class="sd">            data fetching implementation</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame or Series containing the requested data</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the flag is not accepted by this dataset</span>

<span class="sd">    Examples:</span>
<span class="sd">        Basic usage::</span>

<span class="sd">            &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)</span>

<span class="sd">        Override base config options with a dict::</span>

<span class="sd">            &gt;&gt;&gt; # Skip database cache for this fetch</span>
<span class="sd">            &gt;&gt;&gt; prices = dataset.fetch(</span>
<span class="sd">            ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">            ...     config=dict(use_database=False)</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Disable datetime sorting</span>
<span class="sd">            &gt;&gt;&gt; prices = dataset.fetch(</span>
<span class="sd">            ...     &#39;generators_t.p&#39;,</span>
<span class="sd">            ...     config=dict(auto_sort_datetime_index=False)</span>
<span class="sd">            ... )</span>

<span class="sd">        Override platform-specific options::</span>

<span class="sd">            &gt;&gt;&gt; # Platform configs may have additional options</span>
<span class="sd">            &gt;&gt;&gt; # e.g., a config with timestamp conversion setting</span>
<span class="sd">            &gt;&gt;&gt; data = dataset.fetch(</span>
<span class="sd">            ...     &#39;some_flag&#39;,</span>
<span class="sd">            ...     config=dict(convert_period_enum_to_datetime_index=False)</span>
<span class="sd">            ... )</span>

<span class="sd">        Override study-specific options::</span>

<span class="sd">            &gt;&gt;&gt; # Study-specific configs can add custom behavior</span>
<span class="sd">            &gt;&gt;&gt; # e.g., toggle custom data corrections</span>
<span class="sd">            &gt;&gt;&gt; data = dataset.fetch(</span>
<span class="sd">            ...     &#39;some_flag&#39;,</span>
<span class="sd">            ...     config=dict(apply_custom_correction=False)</span>
<span class="sd">            ... )</span>

<span class="sd">        Using a config object::</span>

<span class="sd">            &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">            &gt;&gt;&gt; custom_config = DatasetConfig(</span>
<span class="sd">            ...     use_database=False,</span>
<span class="sd">            ...     auto_sort_datetime_index=False</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;, config=custom_config)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">effective_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">use_database</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">effective_config</span><span class="o">.</span><span class="n">use_database</span>

    <span class="k">if</span> <span class="n">use_database</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">key_is_up_to_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_process_data</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_database</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_database</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">effective_config</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">processed_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.get_accepted_flags_containing_x" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_accepted_flags_containing_x</span>


<a href="#mesqual.datasets.Dataset.get_accepted_flags_containing_x" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_accepted_flags_containing_x</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">match_case</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="set">set</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find all accepted flags containing a specific substring.</p>
<p>Useful for discovering related data flags or filtering flags by category.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Substring to search for in flag names</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>match_case</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, performs case-sensitive search. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="set">set</span>[<span title="mesqual.typevars.FlagType">FlagType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set of accepted flags containing the substring</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; ds = PyPSADataset()
&gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;generators&#39;)
    {&#39;generators&#39;, &#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;, ...}
&gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;BUSES&#39;, match_case=True)
    set()  # Empty because case doesn&#39;t match
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_accepted_flags_containing_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match_case</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find all accepted flags containing a specific substring.</span>

<span class="sd">    Useful for discovering related data flags or filtering flags by category.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Substring to search for in flag names</span>
<span class="sd">        match_case: If True, performs case-sensitive search. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Set of accepted flags containing the substring</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; ds = PyPSADataset()</span>
<span class="sd">        &gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;generators&#39;)</span>
<span class="sd">            {&#39;generators&#39;, &#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;, ...}</span>
<span class="sd">        &gt;&gt;&gt; ds.get_accepted_flags_containing_x(&#39;BUSES&#39;, match_case=True)</span>
<span class="sd">            set()  # Empty because case doesn&#39;t match</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">match_case</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)}</span>
    <span class="n">x_lower</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">if</span> <span class="n">x_lower</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.flag_is_accepted" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">flag_is_accepted</span>


<a href="#mesqual.datasets.Dataset.flag_is_accepted" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">flag_is_accepted</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Boolean check whether a flag is accepted by the Dataset.</p>
<p>This method can be optionally overridden in any child-class
in case you want to follow logic instead of the explicit set of accepted_flags.</p>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flag_is_accepted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Boolean check whether a flag is accepted by the Dataset.</span>

<span class="sd">    This method can be optionally overridden in any child-class</span>
<span class="sd">    in case you want to follow logic instead of the explicit set of accepted_flags.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepted_flags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.dotfetch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">dotfetch</span>


<a href="#mesqual.datasets.Dataset.dotfetch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dotfetch</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="mesqual.datasets.dataset._DotNotationFetcher">_DotNotationFetcher</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a dot notation fetcher for intuitive flag access.</p>
<p>Returns a helper object that allows accessing nested data flags using
Python attribute syntax instead of string-based flags. The fetcher
accumulates attribute accesses and converts them to the appropriate
flag when called.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_DotNotationFetcher</code></td>            <td>
                  <code><span title="mesqual.datasets.dataset._DotNotationFetcher">_DotNotationFetcher</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Helper object enabling chained attribute access</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Using dot notation instead of string flags::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Traditional string-based fetch
&gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)

&gt;&gt;&gt; # Equivalent dot notation fetch
&gt;&gt;&gt; prices = dataset.dotfetch().buses_t.marginal_price()

&gt;&gt;&gt; # Multi-level flag access
&gt;&gt;&gt; gen_power = dataset.dotfetch().generators_t.p()
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dotfetch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_DotNotationFetcher</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a dot notation fetcher for intuitive flag access.</span>

<span class="sd">    Returns a helper object that allows accessing nested data flags using</span>
<span class="sd">    Python attribute syntax instead of string-based flags. The fetcher</span>
<span class="sd">    accumulates attribute accesses and converts them to the appropriate</span>
<span class="sd">    flag when called.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _DotNotationFetcher: Helper object enabling chained attribute access</span>

<span class="sd">    Example:</span>
<span class="sd">        Using dot notation instead of string flags::</span>

<span class="sd">            &gt;&gt;&gt; # Traditional string-based fetch</span>
<span class="sd">            &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)</span>

<span class="sd">            &gt;&gt;&gt; # Equivalent dot notation fetch</span>
<span class="sd">            &gt;&gt;&gt; prices = dataset.dotfetch().buses_t.marginal_price()</span>

<span class="sd">            &gt;&gt;&gt; # Multi-level flag access</span>
<span class="sd">            &gt;&gt;&gt; gen_power = dataset.dotfetch().generators_t.p()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_DotNotationFetcher</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.add_kpis_from_definitions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_kpis_from_definitions</span>


<a href="#mesqual.datasets.Dataset.add_kpis_from_definitions" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_kpis_from_definitions</span><span class="p">(</span><span class="n">kpi_definitions</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            KPIDefinition (mesqual.kpis.definitions.base.KPIDefinition)" href="../kpis/definitions/base/#mesqual.kpis.definitions.base.KPIDefinition">KPIDefinition</a></span> <span class="o">|</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            KPIDefinition (mesqual.kpis.definitions.base.KPIDefinition)" href="../kpis/definitions/base/#mesqual.kpis.definitions.base.KPIDefinition">KPIDefinition</a></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate and add KPIs from one or more KPI definitions.</p>
<p>KPI definitions are templates that generate concrete KPI instances
based on the dataset's structure. This method processes definitions
and adds the resulting KPIs to the dataset's KPI collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kpi_definitions</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            KPIDefinition (mesqual.kpis.definitions.base.KPIDefinition)" href="../kpis/definitions/base/#mesqual.kpis.definitions.base.KPIDefinition">KPIDefinition</a> | <span title="list">list</span>[<a class="autorefs autorefs-internal" title="            KPIDefinition (mesqual.kpis.definitions.base.KPIDefinition)" href="../kpis/definitions/base/#mesqual.kpis.definitions.base.KPIDefinition">KPIDefinition</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single KPIDefinition or list of definitions.
Each definition's generate_kpis() method is called with
this dataset to produce KPI instances.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Adding KPIs from definitions::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mesqual.kpis.definitions import TotalGenerationKPIDefinition
&gt;&gt;&gt; dataset.add_kpis_from_definitions(TotalGenerationKPIDefinition())

&gt;&gt;&gt; # Add multiple definitions at once
&gt;&gt;&gt; definitions = [
...     TotalGenerationKPIDefinition(),
...     MarginalPriceKPIDefinition(),
... ]
&gt;&gt;&gt; dataset.add_kpis_from_definitions(definitions)
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>add_kpi()</code> - Add a single KPI directly</li>
<li><code>add_kpis()</code> - Add multiple KPI instances</li>
<li><a href="../kpis/definitions/base.md">KPI Definitions</a> - Base KPI definition class</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_kpis_from_definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi_definitions</span><span class="p">:</span> <span class="n">KPIDefinition</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">KPIDefinition</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate and add KPIs from one or more KPI definitions.</span>

<span class="sd">    KPI definitions are templates that generate concrete KPI instances</span>
<span class="sd">    based on the dataset&#39;s structure. This method processes definitions</span>
<span class="sd">    and adds the resulting KPIs to the dataset&#39;s KPI collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        kpi_definitions: Single KPIDefinition or list of definitions.</span>
<span class="sd">            Each definition&#39;s generate_kpis() method is called with</span>
<span class="sd">            this dataset to produce KPI instances.</span>

<span class="sd">    Example:</span>
<span class="sd">        Adding KPIs from definitions::</span>

<span class="sd">            &gt;&gt;&gt; from mesqual.kpis.definitions import TotalGenerationKPIDefinition</span>
<span class="sd">            &gt;&gt;&gt; dataset.add_kpis_from_definitions(TotalGenerationKPIDefinition())</span>

<span class="sd">            &gt;&gt;&gt; # Add multiple definitions at once</span>
<span class="sd">            &gt;&gt;&gt; definitions = [</span>
<span class="sd">            ...     TotalGenerationKPIDefinition(),</span>
<span class="sd">            ...     MarginalPriceKPIDefinition(),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; dataset.add_kpis_from_definitions(definitions)</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `add_kpi()` - Add a single KPI directly</span>
<span class="sd">        - `add_kpis()` - Add multiple KPI instances</span>
<span class="sd">        - [KPI Definitions](../kpis/definitions/base.md) - Base KPI definition class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.definitions.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPIDefinition</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_definitions</span><span class="p">,</span> <span class="n">KPIDefinition</span><span class="p">):</span>
        <span class="n">kpis</span> <span class="o">=</span> <span class="n">kpi_definitions</span><span class="o">.</span><span class="n">generate_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_kpis</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">kpi_def</span> <span class="ow">in</span> <span class="n">kpi_definitions</span><span class="p">:</span>
            <span class="n">kpis</span> <span class="o">=</span> <span class="n">kpi_def</span><span class="o">.</span><span class="n">generate_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_kpis</span><span class="p">(</span><span class="n">kpis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.add_kpis" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_kpis</span>


<a href="#mesqual.datasets.Dataset.add_kpis" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_kpis</span><span class="p">(</span><span class="n">kpis</span><span class="p">:</span> <span class="n"><span title="typing.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            KPI


  
      dataclass
   (mesqual.kpis.kpi.KPI)" href="../kpis/kpi/#mesqual.kpis.kpi.KPI">KPI</a></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add multiple KPIs to this dataset's KPI collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kpis</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="            KPI


  
      dataclass
   (mesqual.kpis.kpi.KPI)" href="../kpis/kpi/#mesqual.kpis.kpi.KPI">KPI</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of KPI instances, factories, or classes to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpis</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">KPI</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add multiple KPIs to this dataset&#39;s KPI collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        kpis: Iterable of KPI instances, factories, or classes to add</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duplicates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="n">kpis</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="p">:</span>
            <span class="n">duplicates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_kpi</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">duplicates</span><span class="p">:</span>
        <span class="n">_num_duplicates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicates</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">_num_duplicates</span><span class="si">}</span><span class="s1"> duplicates found and not added again or overwritten in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">. (</span><span class="si">{</span><span class="n">duplicates</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">...)&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.add_kpi" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_kpi</span>


<a href="#mesqual.datasets.Dataset.add_kpi" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_kpi</span><span class="p">(</span><span class="n">kpi</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            KPI


  
      dataclass
   (mesqual.kpis.kpi.KPI)" href="../kpis/kpi/#mesqual.kpis.kpi.KPI">KPI</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a single KPI to this dataset's KPI collection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kpi</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            KPI


  
      dataclass
   (mesqual.kpis.kpi.KPI)" href="../kpis/kpi/#mesqual.kpis.kpi.KPI">KPI</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KPI instance, factory, or class to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_kpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi</span><span class="p">:</span> <span class="n">KPI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a single KPI to this dataset&#39;s KPI collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        kpi: KPI instance, factory, or class to add</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kpi</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.clear_kpi_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">clear_kpi_collection</span>


<a href="#mesqual.datasets.Dataset.clear_kpi_collection" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_kpi_collection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clear the KPI collection.</p>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_kpi_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the KPI collection.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kpi_collection</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.get_attributes_series" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_attributes_series</span>


<a href="#mesqual.datasets.Dataset.get_attributes_series" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_attributes_series</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert dataset attributes to a pandas Series.</p>
<p>Creates a Series with attribute names as the index and attribute
values as data. The Series name is set to the dataset name, making
it suitable for concatenation with other datasets' attribute series.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.Series: Series containing attribute values, indexed by attribute
names, with the dataset name as the Series name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Converting attributes and combining across datasets::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; dataset.set_attributes(year=2030, carbon_price=50.0)
&gt;&gt;&gt; series = dataset.get_attributes_series()
&gt;&gt;&gt; series
year            2030
carbon_price    50.0
Name: Scenario_A, dtype: object

&gt;&gt;&gt; # Combine attributes from multiple datasets
&gt;&gt;&gt; attr_df = pd.concat([d.get_attributes_series() for d in collection], axis=1).T
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>attributes</code> - Access raw attributes dictionary</li>
<li><code>set_attributes()</code> - Set attribute values</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_attributes_series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert dataset attributes to a pandas Series.</span>

<span class="sd">    Creates a Series with attribute names as the index and attribute</span>
<span class="sd">    values as data. The Series name is set to the dataset name, making</span>
<span class="sd">    it suitable for concatenation with other datasets&#39; attribute series.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Series: Series containing attribute values, indexed by attribute</span>
<span class="sd">            names, with the dataset name as the Series name</span>

<span class="sd">    Example:</span>
<span class="sd">        Converting attributes and combining across datasets::</span>

<span class="sd">            &gt;&gt;&gt; dataset.set_attributes(year=2030, carbon_price=50.0)</span>
<span class="sd">            &gt;&gt;&gt; series = dataset.get_attributes_series()</span>
<span class="sd">            &gt;&gt;&gt; series</span>
<span class="sd">            year            2030</span>
<span class="sd">            carbon_price    50.0</span>
<span class="sd">            Name: Scenario_A, dtype: object</span>

<span class="sd">            &gt;&gt;&gt; # Combine attributes from multiple datasets</span>
<span class="sd">            &gt;&gt;&gt; attr_df = pd.concat([d.get_attributes_series() for d in collection], axis=1).T</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `attributes` - Access raw attributes dictionary</span>
<span class="sd">        - `set_attributes()` - Set attribute values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">att_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">att_series</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.set_attributes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_attributes</span>


<a href="#mesqual.datasets.Dataset.set_attributes" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_attributes</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set one or more metadata attributes on this dataset.</p>
<p>Attributes are key-value pairs that store scenario metadata. They must
use string keys and primitive values (bool, int, float, str) to ensure
serializability and consistent comparison behavior.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Attribute key-value pairs to set. Keys must be strings,
values must be bool, int, float, or str.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any key is not a string</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any value is not bool, int, float, or str</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Setting scenario metadata::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; dataset.set_attributes(
...     year=2030,
...     scenario_type=&#39;high_renewable&#39;,
...     carbon_price=50.0,
...     includes_nuclear=True
... )

&gt;&gt;&gt; # Access the attributes
&gt;&gt;&gt; dataset.attributes[&#39;year&#39;]
2030
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>attributes</code> - Access attributes dictionary</li>
<li><code>get_attributes_series()</code> - Convert to pandas Series</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set one or more metadata attributes on this dataset.</span>

<span class="sd">    Attributes are key-value pairs that store scenario metadata. They must</span>
<span class="sd">    use string keys and primitive values (bool, int, float, str) to ensure</span>
<span class="sd">    serializability and consistent comparison behavior.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: Attribute key-value pairs to set. Keys must be strings,</span>
<span class="sd">            values must be bool, int, float, or str.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If any key is not a string</span>
<span class="sd">        TypeError: If any value is not bool, int, float, or str</span>

<span class="sd">    Example:</span>
<span class="sd">        Setting scenario metadata::</span>

<span class="sd">            &gt;&gt;&gt; dataset.set_attributes(</span>
<span class="sd">            ...     year=2030,</span>
<span class="sd">            ...     scenario_type=&#39;high_renewable&#39;,</span>
<span class="sd">            ...     carbon_price=50.0,</span>
<span class="sd">            ...     includes_nuclear=True</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; # Access the attributes</span>
<span class="sd">            &gt;&gt;&gt; dataset.attributes[&#39;year&#39;]</span>
<span class="sd">            2030</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `attributes` - Access attributes dictionary</span>
<span class="sd">        - `get_attributes_series()` - Convert to pandas Series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Attribute keys must be of type str. Your key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Attribute values must be of type (bool, int, flaot, str). &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;Your value for </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">) is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.required_flags_for_flag" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">required_flags_for_flag</span>


<a href="#mesqual.datasets.Dataset.required_flags_for_flag" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">required_flags_for_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="set">set</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the set of flags required to compute a given flag.</p>
<p>For derived or computed flags, this method returns the set of source
flags that must be available to produce the requested data. This is
useful for understanding data dependencies and ensuring prerequisite
data exists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flag</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.FlagType">FlagType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flag to check requirements for. Must be in accepted_flags.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="set">set</span>[<span title="mesqual.typevars.FlagType">FlagType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set[FlagType]: Set of flags that are required to compute the given flag.
Returns an empty set if the flag has no dependencies.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the flag is not accepted by this dataset</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Checking data dependencies::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # A derived flag might depend on multiple source flags
&gt;&gt;&gt; deps = dataset.required_flags_for_flag(&#39;total_generation&#39;)
&gt;&gt;&gt; deps
{&#39;generators_t.p&#39;, &#39;generators&#39;}
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>_required_flags_for_flag()</code> - Abstract method to implement</li>
<li><code>flag_is_accepted()</code> - Check if a flag is valid</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@flag_must_be_accepted</span>
<span class="k">def</span><span class="w"> </span><span class="nf">required_flags_for_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the set of flags required to compute a given flag.</span>

<span class="sd">    For derived or computed flags, this method returns the set of source</span>
<span class="sd">    flags that must be available to produce the requested data. This is</span>
<span class="sd">    useful for understanding data dependencies and ensuring prerequisite</span>
<span class="sd">    data exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        flag: The flag to check requirements for. Must be in accepted_flags.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set[FlagType]: Set of flags that are required to compute the given flag.</span>
<span class="sd">            Returns an empty set if the flag has no dependencies.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the flag is not accepted by this dataset</span>

<span class="sd">    Example:</span>
<span class="sd">        Checking data dependencies::</span>

<span class="sd">            &gt;&gt;&gt; # A derived flag might depend on multiple source flags</span>
<span class="sd">            &gt;&gt;&gt; deps = dataset.required_flags_for_flag(&#39;total_generation&#39;)</span>
<span class="sd">            &gt;&gt;&gt; deps</span>
<span class="sd">            {&#39;generators_t.p&#39;, &#39;generators&#39;}</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `_required_flags_for_flag()` - Abstract method to implement</span>
<span class="sd">        - `flag_is_accepted()` - Check if a flag is valid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_flags_for_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.fetch_multiple_flags_and_concat" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fetch_multiple_flags_and_concat</span>


<a href="#mesqual.datasets.Dataset.fetch_multiple_flags_and_concat" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fetch_multiple_flags_and_concat</span><span class="p">(</span><span class="n">flags</span><span class="p">:</span> <span class="n"><span title="typing.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">],</span> <span class="n">concat_axis</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">concat_level_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">concat_level_at_top</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fetch multiple flags and concatenate results into a single DataFrame.</p>
<p>Convenience method for retrieving data from multiple flags and combining
them into a single DataFrame with a MultiIndex. Useful for comparative
analysis of multiple variables or creating wide-format data structures.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flags</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="mesqual.typevars.FlagType">FlagType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of flags to fetch and concatenate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concat_axis</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Axis along which to concatenate (0=rows, 1=columns).
Default is 1 (columns).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concat_level_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the new MultiIndex level identifying
the source flag. Default is 'variable'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;variable&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concat_level_at_top</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the flag level is the outermost level
in the MultiIndex. If False, it's moved to the innermost level.
Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional configuration override (see fetch() for details)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to each fetch() call</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with concatenated data and a MultiIndex identifying the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>source flag for each section</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Fetching and comparing multiple variables::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Fetch power output and efficiency for generators
&gt;&gt;&gt; combined = dataset.fetch_multiple_flags_and_concat(
...     flags=[&#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;],
...     concat_level_name=&#39;metric&#39;
... )
&gt;&gt;&gt; # Result has MultiIndex columns: (metric, generator_name)

&gt;&gt;&gt; # Row-wise concatenation
&gt;&gt;&gt; stacked = dataset.fetch_multiple_flags_and_concat(
...     flags=[&#39;bus_A_prices&#39;, &#39;bus_B_prices&#39;],
...     concat_axis=0,
...     concat_level_name=&#39;bus&#39;
... )
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>fetch()</code> - Single flag data retrieval</li>
<li><code>fetch_filter_groupby_agg()</code> - Fetch with filtering and aggregation</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_multiple_flags_and_concat</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FlagType</span><span class="p">],</span>
        <span class="n">concat_axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">concat_level_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span>
        <span class="n">concat_level_at_top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch multiple flags and concatenate results into a single DataFrame.</span>

<span class="sd">    Convenience method for retrieving data from multiple flags and combining</span>
<span class="sd">    them into a single DataFrame with a MultiIndex. Useful for comparative</span>
<span class="sd">    analysis of multiple variables or creating wide-format data structures.</span>

<span class="sd">    Args:</span>
<span class="sd">        flags: Iterable of flags to fetch and concatenate</span>
<span class="sd">        concat_axis: Axis along which to concatenate (0=rows, 1=columns).</span>
<span class="sd">            Default is 1 (columns).</span>
<span class="sd">        concat_level_name: Name for the new MultiIndex level identifying</span>
<span class="sd">            the source flag. Default is &#39;variable&#39;.</span>
<span class="sd">        concat_level_at_top: If True, the flag level is the outermost level</span>
<span class="sd">            in the MultiIndex. If False, it&#39;s moved to the innermost level.</span>
<span class="sd">            Default is True.</span>
<span class="sd">        config: Optional configuration override (see fetch() for details)</span>
<span class="sd">        **kwargs: Additional arguments passed to each fetch() call</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame with concatenated data and a MultiIndex identifying the</span>
<span class="sd">        source flag for each section</span>

<span class="sd">    Example:</span>
<span class="sd">        Fetching and comparing multiple variables::</span>

<span class="sd">            &gt;&gt;&gt; # Fetch power output and efficiency for generators</span>
<span class="sd">            &gt;&gt;&gt; combined = dataset.fetch_multiple_flags_and_concat(</span>
<span class="sd">            ...     flags=[&#39;generators_t.p&#39;, &#39;generators_t.efficiency&#39;],</span>
<span class="sd">            ...     concat_level_name=&#39;metric&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Result has MultiIndex columns: (metric, generator_name)</span>

<span class="sd">            &gt;&gt;&gt; # Row-wise concatenation</span>
<span class="sd">            &gt;&gt;&gt; stacked = dataset.fetch_multiple_flags_and_concat(</span>
<span class="sd">            ...     flags=[&#39;bus_A_prices&#39;, &#39;bus_B_prices&#39;],</span>
<span class="sd">            ...     concat_axis=0,</span>
<span class="sd">            ...     concat_level_name=&#39;bus&#39;</span>
<span class="sd">            ... )</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `fetch()` - Single flag data retrieval</span>
<span class="sd">        - `fetch_filter_groupby_agg()` - Fetch with filtering and aggregation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dfs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span>
    <span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="n">dfs</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">concat_axis</span><span class="p">,</span>
        <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">concat_level_name</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">concat_level_at_top</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">nlevels</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.fetch_filter_groupby_agg" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fetch_filter_groupby_agg</span>


<a href="#mesqual.datasets.Dataset.fetch_filter_groupby_agg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fetch_filter_groupby_agg</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">,</span> <span class="n">model_filter_query</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">prop_groupby</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">prop_groupby_agg</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span> <span class="o">|</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fetch data with model-based filtering, grouping, and aggregation.</p>
<p>Provides a powerful one-line method for common data analysis patterns:
filter time series by model properties, group by categories, and
aggregate results. Requires a flag index with model mappings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flag</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.FlagType">FlagType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data flag to fetch (must have a linked model flag)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_filter_query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas query string to filter based on model
properties. Applied to the linked model DataFrame.
Example: "carrier == 'solar'" or "p_nom &gt; 100"</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prop_groupby</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model property or list of properties to group by.
Adds these as MultiIndex levels and groups the data.
Example: 'carrier' or ['carrier', 'bus']</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prop_groupby_agg</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation function to apply after grouping.
Standard pandas aggregation strings like 'sum', 'mean', 'max'.
Only used if prop_groupby is specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional configuration override (see fetch() for details)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to fetch()</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtered and/or aggregated data. If prop_groupby is specified without</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>prop_groupby_agg, returns a DataFrameGroupBy object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the flag has no linked model flag in the flag index</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Common analysis patterns::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Filter generators to only solar, sum by carrier
&gt;&gt;&gt; solar_gen = dataset.fetch_filter_groupby_agg(
...     &#39;generators_t.p&#39;,
...     model_filter_query=&quot;carrier == &#39;solar&#39;&quot;,
...     prop_groupby=&#39;carrier&#39;,
...     prop_groupby_agg=&#39;sum&#39;
... )

&gt;&gt;&gt; # Group all generation by carrier and bus
&gt;&gt;&gt; by_carrier_bus = dataset.fetch_filter_groupby_agg(
...     &#39;generators_t.p&#39;,
...     prop_groupby=[&#39;carrier&#39;, &#39;bus&#39;],
...     prop_groupby_agg=&#39;sum&#39;
... )

&gt;&gt;&gt; # Filter to large generators only
&gt;&gt;&gt; large_gens = dataset.fetch_filter_groupby_agg(
...     &#39;generators_t.p&#39;,
...     model_filter_query=&quot;p_nom &gt;= 500&quot;
... )
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>fetch()</code> - Basic data retrieval</li>
<li><a href="../utils/pandas_utils/index.md">Pandas Utils</a> - Underlying filter/group utilities</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_filter_groupby_agg</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
        <span class="n">model_filter_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prop_groupby</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prop_groupby_agg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch data with model-based filtering, grouping, and aggregation.</span>

<span class="sd">    Provides a powerful one-line method for common data analysis patterns:</span>
<span class="sd">    filter time series by model properties, group by categories, and</span>
<span class="sd">    aggregate results. Requires a flag index with model mappings.</span>

<span class="sd">    Args:</span>
<span class="sd">        flag: Data flag to fetch (must have a linked model flag)</span>
<span class="sd">        model_filter_query: Pandas query string to filter based on model</span>
<span class="sd">            properties. Applied to the linked model DataFrame.</span>
<span class="sd">            Example: &quot;carrier == &#39;solar&#39;&quot; or &quot;p_nom &gt; 100&quot;</span>
<span class="sd">        prop_groupby: Model property or list of properties to group by.</span>
<span class="sd">            Adds these as MultiIndex levels and groups the data.</span>
<span class="sd">            Example: &#39;carrier&#39; or [&#39;carrier&#39;, &#39;bus&#39;]</span>
<span class="sd">        prop_groupby_agg: Aggregation function to apply after grouping.</span>
<span class="sd">            Standard pandas aggregation strings like &#39;sum&#39;, &#39;mean&#39;, &#39;max&#39;.</span>
<span class="sd">            Only used if prop_groupby is specified.</span>
<span class="sd">        config: Optional configuration override (see fetch() for details)</span>
<span class="sd">        **kwargs: Additional arguments passed to fetch()</span>

<span class="sd">    Returns:</span>
<span class="sd">        Filtered and/or aggregated data. If prop_groupby is specified without</span>
<span class="sd">        prop_groupby_agg, returns a DataFrameGroupBy object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the flag has no linked model flag in the flag index</span>

<span class="sd">    Example:</span>
<span class="sd">        Common analysis patterns::</span>

<span class="sd">            &gt;&gt;&gt; # Filter generators to only solar, sum by carrier</span>
<span class="sd">            &gt;&gt;&gt; solar_gen = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">            ...     &#39;generators_t.p&#39;,</span>
<span class="sd">            ...     model_filter_query=&quot;carrier == &#39;solar&#39;&quot;,</span>
<span class="sd">            ...     prop_groupby=&#39;carrier&#39;,</span>
<span class="sd">            ...     prop_groupby_agg=&#39;sum&#39;</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; # Group all generation by carrier and bus</span>
<span class="sd">            &gt;&gt;&gt; by_carrier_bus = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">            ...     &#39;generators_t.p&#39;,</span>
<span class="sd">            ...     prop_groupby=[&#39;carrier&#39;, &#39;bus&#39;],</span>
<span class="sd">            ...     prop_groupby_agg=&#39;sum&#39;</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; # Filter to large generators only</span>
<span class="sd">            &gt;&gt;&gt; large_gens = dataset.fetch_filter_groupby_agg(</span>
<span class="sd">            ...     &#39;generators_t.p&#39;,</span>
<span class="sd">            ...     model_filter_query=&quot;p_nom &gt;= 500&quot;</span>
<span class="sd">            ... )</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `fetch()` - Basic data retrieval</span>
<span class="sd">        - [Pandas Utils](../utils/pandas_utils/index.md) - Underlying filter/group utilities</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_index</span><span class="o">.</span><span class="n">get_linked_model_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">model_flag</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FlagIndex could not successfully map flag </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s1"> to a model flag.&#39;</span><span class="p">)</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">pandas_utils</span>

    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetCollection</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DatasetCollection</span><span class="p">):</span>
        <span class="c1"># TODO: implement MultiIndex capabilities into filter_by_model_query / prepend_model_prop_levels, then fetch_merged is not needed</span>
        <span class="n">model_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_merged</span><span class="p">(</span><span class="n">model_flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">model_flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model_filter_query</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pandas_utils</span><span class="o">.</span><span class="n">filter_by_model_query</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model_df</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">model_filter_query</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">prop_groupby</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_groupby</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">prop_groupby</span> <span class="o">=</span> <span class="p">[</span><span class="n">prop_groupby</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pandas_utils</span><span class="o">.</span><span class="n">prepend_model_prop_levels</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model_df</span><span class="p">,</span> <span class="o">*</span><span class="n">prop_groupby</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">prop_groupby</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop_groupby_agg</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">prop_groupby_agg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_groupby_agg</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;You provided a prop_groupby_agg operation, but didn&#39;t provide prop_groupby. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;No aggregation performed.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.get_flag_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_flag_type</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.get_flag_type" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_flag_type</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the flag type class for this dataset type.</p>
<p>Returns the type used for data flags in this dataset class. Subclasses
can override to specify a custom flag type for type checking and
validation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Type">Type</span>[<span title="mesqual.typevars.FlagType">FlagType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type[FlagType]: The flag type class (default: FlagTypeProtocol)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Override in subclasses that use custom flag types.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_flag_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the flag type class for this dataset type.</span>

<span class="sd">    Returns the type used for data flags in this dataset class. Subclasses</span>
<span class="sd">    can override to specify a custom flag type for type checking and</span>
<span class="sd">    validation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Type[FlagType]: The flag type class (default: FlagTypeProtocol)</span>

<span class="sd">    Note:</span>
<span class="sd">        Override in subclasses that use custom flag types.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.flag.flag</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlagTypeProtocol</span>
    <span class="k">return</span> <span class="n">FlagTypeProtocol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.get_flag_index_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_flag_index_type</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.get_flag_index_type" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_flag_index_type</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.FlagIndexType">FlagIndexType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the flag index type class for this dataset type.</p>
<p>Returns the type used for the flag index in this dataset class.
Subclasses can override to specify a custom flag index implementation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Type">Type</span>[<span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type[FlagIndexType]: The flag index type class (default: FlagIndex)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Override in subclasses that use platform-specific flag indices.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_flag_index_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">FlagIndexType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the flag index type class for this dataset type.</span>

<span class="sd">    Returns the type used for the flag index in this dataset class.</span>
<span class="sd">    Subclasses can override to specify a custom flag index implementation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Type[FlagIndexType]: The flag index type class (default: FlagIndex)</span>

<span class="sd">    Note:</span>
<span class="sd">        Override in subclasses that use platform-specific flag indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.flag.flag_index</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlagIndex</span>
    <span class="k">return</span> <span class="n">FlagIndex</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.get_config_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_config_type</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.get_config_type" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_config_type</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the configuration type class for this dataset type.</p>
<p>Returns the DatasetConfig subclass used by this dataset. Platform
interfaces typically override this to return their extended config
class with platform-specific options.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Type">Type</span>[<span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type[DatasetConfigType]: The config type class (default: DatasetConfig)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Creating a config instance for this dataset type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; ConfigClass = MyDataset.get_config_type()
&gt;&gt;&gt; config = ConfigClass(use_database=True)
</code></pre></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Override in platform dataset subclasses to return platform-specific
config types with additional options.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_config_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetConfigType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the configuration type class for this dataset type.</span>

<span class="sd">    Returns the DatasetConfig subclass used by this dataset. Platform</span>
<span class="sd">    interfaces typically override this to return their extended config</span>
<span class="sd">    class with platform-specific options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Type[DatasetConfigType]: The config type class (default: DatasetConfig)</span>

<span class="sd">    Example:</span>
<span class="sd">        Creating a config instance for this dataset type::</span>

<span class="sd">            &gt;&gt;&gt; ConfigClass = MyDataset.get_config_type()</span>
<span class="sd">            &gt;&gt;&gt; config = ConfigClass(use_database=True)</span>

<span class="sd">    Note:</span>
<span class="sd">        Override in platform dataset subclasses to return platform-specific</span>
<span class="sd">        config types with additional options.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfig</span>
    <span class="k">return</span> <span class="n">DatasetConfig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.set_instance_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_instance_config</span>


<a href="#mesqual.datasets.Dataset.set_instance_config" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_instance_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace the instance-level configuration for this dataset.</p>
<p>Sets the configuration that will be merged with class-level defaults
to produce the effective configuration used by fetch().</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New configuration object to use for this instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Setting a custom configuration::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mesqual.datasets import DatasetConfig
&gt;&gt;&gt; config = DatasetConfig(use_database=False, auto_sort_datetime_index=False)
&gt;&gt;&gt; dataset.set_instance_config(config)
</code></pre></div>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>instance_config</code> - Get the effective configuration</li>
<li><code>set_instance_config_kwargs()</code> - Update individual settings</li>
<li><code>set_class_config()</code> - Set class-level defaults</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_instance_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replace the instance-level configuration for this dataset.</span>

<span class="sd">    Sets the configuration that will be merged with class-level defaults</span>
<span class="sd">    to produce the effective configuration used by fetch().</span>

<span class="sd">    Args:</span>
<span class="sd">        config: New configuration object to use for this instance</span>

<span class="sd">    Example:</span>
<span class="sd">        Setting a custom configuration::</span>

<span class="sd">            &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">            &gt;&gt;&gt; config = DatasetConfig(use_database=False, auto_sort_datetime_index=False)</span>
<span class="sd">            &gt;&gt;&gt; dataset.set_instance_config(config)</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `instance_config` - Get the effective configuration</span>
<span class="sd">        - `set_instance_config_kwargs()` - Update individual settings</span>
<span class="sd">        - `set_class_config()` - Set class-level defaults</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.set_instance_config_kwargs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_instance_config_kwargs</span>


<a href="#mesqual.datasets.Dataset.set_instance_config_kwargs" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_instance_config_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update individual configuration settings on this instance.</p>
<p>Modifies specific attributes of the existing instance configuration
without replacing the entire config object. Useful for tweaking
individual settings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration attribute names and values to set</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Adjusting specific settings::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; dataset.set_instance_config_kwargs(
...     use_database=True,
...     auto_sort_datetime_index=False
... )
</code></pre></div>
</details>

<details class="warning" open>
  <summary>Warning</summary>
  <p>Raises AttributeError if the config attribute doesn't exist.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>set_instance_config()</code> - Replace entire configuration</li>
<li><code>instance_config</code> - Get the effective configuration</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_instance_config_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update individual configuration settings on this instance.</span>

<span class="sd">    Modifies specific attributes of the existing instance configuration</span>
<span class="sd">    without replacing the entire config object. Useful for tweaking</span>
<span class="sd">    individual settings.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: Configuration attribute names and values to set</span>

<span class="sd">    Example:</span>
<span class="sd">        Adjusting specific settings::</span>

<span class="sd">            &gt;&gt;&gt; dataset.set_instance_config_kwargs(</span>
<span class="sd">            ...     use_database=True,</span>
<span class="sd">            ...     auto_sort_datetime_index=False</span>
<span class="sd">            ... )</span>

<span class="sd">    Warning:</span>
<span class="sd">        Raises AttributeError if the config attribute doesn&#39;t exist.</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `set_instance_config()` - Replace entire configuration</span>
<span class="sd">        - `instance_config` - Get the effective configuration</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.Dataset.set_class_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_class_config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mesqual.datasets.Dataset.set_class_config" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_class_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the class-level configuration for all instances of this dataset type.</p>
<p>Class-level configuration serves as the default for all instances of
this class. Instance-level configuration (set via set_instance_config)
can override these defaults.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object to use as class-level defaults</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Setting defaults for all instances::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mesqual.datasets import DatasetConfig
&gt;&gt;&gt; config = DatasetConfig(use_database=True)
&gt;&gt;&gt; MyDataset.set_class_config(config)
&gt;&gt;&gt;
&gt;&gt;&gt; # All new instances will use database by default
&gt;&gt;&gt; ds1 = MyDataset()  # uses database
&gt;&gt;&gt; ds2 = MyDataset()  # uses database
</code></pre></div>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This affects all instances of the class, including existing ones
that haven't overridden the setting at instance level.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>set_instance_config()</code> - Override for specific instances</li>
<li>DatasetConfigManager - Configuration management system</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_class_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the class-level configuration for all instances of this dataset type.</span>

<span class="sd">    Class-level configuration serves as the default for all instances of</span>
<span class="sd">    this class. Instance-level configuration (set via set_instance_config)</span>
<span class="sd">    can override these defaults.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object to use as class-level defaults</span>

<span class="sd">    Example:</span>
<span class="sd">        Setting defaults for all instances::</span>

<span class="sd">            &gt;&gt;&gt; from mesqual.datasets import DatasetConfig</span>
<span class="sd">            &gt;&gt;&gt; config = DatasetConfig(use_database=True)</span>
<span class="sd">            &gt;&gt;&gt; MyDataset.set_class_config(config)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # All new instances will use database by default</span>
<span class="sd">            &gt;&gt;&gt; ds1 = MyDataset()  # uses database</span>
<span class="sd">            &gt;&gt;&gt; ds2 = MyDataset()  # uses database</span>

<span class="sd">    Note:</span>
<span class="sd">        This affects all instances of the class, including existing ones</span>
<span class="sd">        that haven&#39;t overridden the setting at instance level.</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `set_instance_config()` - Override for specific instances</span>
<span class="sd">        - DatasetConfigManager - Configuration management system</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.datasets.dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetConfigManager</span>
    <span class="n">DatasetConfigManager</span><span class="o">.</span><span class="n">set_class_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetCollection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetCollection</span>


<a href="#mesqual.datasets.DatasetCollection" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            Dataset (mesqual.datasets.dataset.Dataset)" href="#mesqual.datasets.Dataset">Dataset</a>[<span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for collections of datasets.</p>
<p>DatasetCollection extends the Dataset interface to handle multiple child datasets
while maintaining the same unified API. This enables complex hierarchical structures
where collections themselves can be treated as datasets.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Inherits all Dataset functionality</li>
<li>Manages collections of child datasets</li>
<li>Provides iteration and access methods</li>
<li>Aggregates accepted flags from all children</li>
<li>Supports KPI operations across all sub-datasets</li>
</ul>
</details>

<p>
      <span class="doc-section-title">
        Class Type Parameters:
      </span>
    </p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Bound or Constraints</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DatasetType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of datasets that can be collected</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>DatasetConfigType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration class for dataset behavior</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type used for data flag identification</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagIndexType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag index implementation for flag mapping</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetCollection.datasets">datasets</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of child datasets in this collection</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This class follows the "Everything is a Dataset" principle, allowing
collections to be used anywhere a Dataset is expected.</p>
</details>







              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetCollection</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">Dataset</span><span class="p">[</span><span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">ABC</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for collections of datasets.</span>

<span class="sd">    DatasetCollection extends the Dataset interface to handle multiple child datasets</span>
<span class="sd">    while maintaining the same unified API. This enables complex hierarchical structures</span>
<span class="sd">    where collections themselves can be treated as datasets.</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - Inherits all Dataset functionality</span>
<span class="sd">        - Manages collections of child datasets</span>
<span class="sd">        - Provides iteration and access methods</span>
<span class="sd">        - Aggregates accepted flags from all children</span>
<span class="sd">        - Supports KPI operations across all sub-datasets</span>

<span class="sd">    Type Parameters:</span>
<span class="sd">        DatasetType: Type of datasets that can be collected</span>
<span class="sd">        DatasetConfigType: Configuration class for dataset behavior</span>
<span class="sd">        FlagType: Type used for data flag identification</span>
<span class="sd">        FlagIndexType: Flag index implementation for flag mapping</span>

<span class="sd">    Attributes:</span>
<span class="sd">        datasets (list[DatasetType]): List of child datasets in this collection</span>

<span class="sd">    Note:</span>
<span class="sd">        This class follows the &quot;Everything is a Dataset&quot; principle, allowing</span>
<span class="sd">        collections to be used anywhere a Dataset is expected.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="o">=</span><span class="n">parent_dataset</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="o">=</span><span class="n">flag_index</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]</span> <span class="o">=</span> <span class="n">datasets</span> <span class="k">if</span> <span class="n">datasets</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">ds</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flag_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FlagIndex</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.flag.flag_index</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmptyFlagIndex</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span><span class="p">,</span> <span class="n">EmptyFlagIndex</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.utils.check_all_same</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_same_object</span>
            <span class="k">if</span> <span class="n">all_same_object</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">flag_index</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">flag_index</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_index</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">child_dataset_atts</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">attributes</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">]</span>
        <span class="n">attributes_that_all_childs_have_in_common</span> <span class="o">=</span> <span class="n">get_intersection_of_dicts</span><span class="p">(</span><span class="n">child_dataset_atts</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">attributes_that_all_childs_have_in_common</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_merged_kpi_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KPICollection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge KPI collections from all child datasets.</span>

<span class="sd">        This method collects KPIs from all child datasets&#39; kpi_collection</span>
<span class="sd">        properties and returns a unified collection. Optionally recurses into</span>
<span class="sd">        nested DatasetCollections.</span>

<span class="sd">        Args:</span>
<span class="sd">            deep: If True, recursively merge from nested DatasetCollections</span>

<span class="sd">        Returns:</span>
<span class="sd">            KPICollection containing all KPIs from all child datasets</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; # Create KPIs for all scenarios</span>
<span class="sd">            &gt;&gt;&gt; study.scen: DatasetConcatCollection</span>
<span class="sd">            &gt;&gt;&gt; study.scen.add_kpis_from_definitions_to_all_child_datasets(kpi_defs)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Get merged collection across all scenarios</span>
<span class="sd">            &gt;&gt;&gt; all_kpis = study.scen.get_merged_kpi_collection()</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Filter and export</span>
<span class="sd">            &gt;&gt;&gt; mean_prices = all_kpis.filter_by(aggregation=Aggregations.Mean)</span>
<span class="sd">            &gt;&gt;&gt; df = mean_prices.to_dataframe(unit_handling=&#39;auto_convert&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="c1"># Add KPIs from this dataset</span>
            <span class="n">merged</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">kpi_collection</span><span class="o">.</span><span class="n">_kpis</span><span class="p">)</span>

            <span class="c1"># Recursively add from nested collections</span>
            <span class="k">if</span> <span class="n">deep</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">DatasetCollection</span><span class="p">):</span>
                <span class="n">nested_merged</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_merged_kpi_collection</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">)</span>
                <span class="n">merged</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nested_merged</span><span class="o">.</span><span class="n">_kpis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">merged</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_kpis_from_definitions_to_all_child_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi_definitions</span><span class="p">:</span> <span class="n">KPIDefinition</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">KPIDefinition</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_iterator</span><span class="p">:</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">add_kpis_from_definitions</span><span class="p">(</span><span class="n">kpi_definitions</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_kpi_collection_for_all_child_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">clear_kpi_collection</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">deep</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">DatasetCollection</span><span class="p">):</span>
                <span class="n">ds</span><span class="o">.</span><span class="n">clear_kpi_collection_for_all_child_datasets</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flag_is_accepted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">flag_is_accepted</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">accepted_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">nested_union</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_required_flags_for_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">nested_union</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">accepted_flags</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetType</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No datasets available&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ds</span>

        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset with name &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datasets</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_dataset</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetType</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_child_dataset_type</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can only add data sets of type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_child_dataset_type</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">existing</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">existing</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">dataset</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;dataset </span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> already in this collection. Replacing it.&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_child_dataset_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Dataset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_merged</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">keep_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch method that merges dataframes from all child datasets, similar to DatasetMergeCollection.&quot;&quot;&quot;</span>
        <span class="n">temp_merge_collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_dataset_collection</span><span class="p">(</span><span class="n">keep_first</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temp_merge_collection</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_merged_dataset_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatasetMergeCollection&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DatasetMergeCollection</span><span class="p">(</span>
            <span class="n">datasets</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> merged&quot;</span><span class="p">,</span>
            <span class="n">keep_first</span><span class="o">=</span><span class="n">keep_first</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetCollection.get_merged_kpi_collection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_merged_kpi_collection</span>


<a href="#mesqual.datasets.DatasetCollection.get_merged_kpi_collection" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_merged_kpi_collection</span><span class="p">(</span><span class="n">deep</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            KPICollection (mesqual.kpis.collection.KPICollection)" href="../kpis/collection/#mesqual.kpis.collection.KPICollection">KPICollection</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge KPI collections from all child datasets.</p>
<p>This method collects KPIs from all child datasets' kpi_collection
properties and returns a unified collection. Optionally recurses into
nested DatasetCollections.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>deep</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, recursively merge from nested DatasetCollections</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            KPICollection (mesqual.kpis.collection.KPICollection)" href="../kpis/collection/#mesqual.kpis.collection.KPICollection">KPICollection</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KPICollection containing all KPIs from all child datasets</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Create KPIs for all scenarios
&gt;&gt;&gt; study.scen: DatasetConcatCollection
&gt;&gt;&gt; study.scen.add_kpis_from_definitions_to_all_child_datasets(kpi_defs)
&gt;&gt;&gt;
&gt;&gt;&gt; # Get merged collection across all scenarios
&gt;&gt;&gt; all_kpis = study.scen.get_merged_kpi_collection()
&gt;&gt;&gt;
&gt;&gt;&gt; # Filter and export
&gt;&gt;&gt; mean_prices = all_kpis.filter_by(aggregation=Aggregations.Mean)
&gt;&gt;&gt; df = mean_prices.to_dataframe(unit_handling=&#39;auto_convert&#39;)
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_merged_kpi_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KPICollection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge KPI collections from all child datasets.</span>

<span class="sd">    This method collects KPIs from all child datasets&#39; kpi_collection</span>
<span class="sd">    properties and returns a unified collection. Optionally recurses into</span>
<span class="sd">    nested DatasetCollections.</span>

<span class="sd">    Args:</span>
<span class="sd">        deep: If True, recursively merge from nested DatasetCollections</span>

<span class="sd">    Returns:</span>
<span class="sd">        KPICollection containing all KPIs from all child datasets</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Create KPIs for all scenarios</span>
<span class="sd">        &gt;&gt;&gt; study.scen: DatasetConcatCollection</span>
<span class="sd">        &gt;&gt;&gt; study.scen.add_kpis_from_definitions_to_all_child_datasets(kpi_defs)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Get merged collection across all scenarios</span>
<span class="sd">        &gt;&gt;&gt; all_kpis = study.scen.get_merged_kpi_collection()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Filter and export</span>
<span class="sd">        &gt;&gt;&gt; mean_prices = all_kpis.filter_by(aggregation=Aggregations.Mean)</span>
<span class="sd">        &gt;&gt;&gt; df = mean_prices.to_dataframe(unit_handling=&#39;auto_convert&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.kpis.collection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KPICollection</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="n">KPICollection</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
        <span class="c1"># Add KPIs from this dataset</span>
        <span class="n">merged</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">kpi_collection</span><span class="o">.</span><span class="n">_kpis</span><span class="p">)</span>

        <span class="c1"># Recursively add from nested collections</span>
        <span class="k">if</span> <span class="n">deep</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">DatasetCollection</span><span class="p">):</span>
            <span class="n">nested_merged</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_merged_kpi_collection</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">)</span>
            <span class="n">merged</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nested_merged</span><span class="o">.</span><span class="n">_kpis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetCollection.fetch_merged" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fetch_merged</span>


<a href="#mesqual.datasets.DatasetCollection.fetch_merged" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fetch_merged</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keep_first</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span> <span class="o">|</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fetch method that merges dataframes from all child datasets, similar to DatasetMergeCollection.</p>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_merged</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keep_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch method that merges dataframes from all child datasets, similar to DatasetMergeCollection.&quot;&quot;&quot;</span>
    <span class="n">temp_merge_collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_dataset_collection</span><span class="p">(</span><span class="n">keep_first</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp_merge_collection</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetLinkCollection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetLinkCollection</span>


<a href="#mesqual.datasets.DatasetLinkCollection" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            DatasetCollection (mesqual.datasets.dataset_collection.DatasetCollection)" href="#mesqual.datasets.DatasetCollection">DatasetCollection</a>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code></p>


        <p>Links specialized flag interpreters into a unified platform dataset interface.</p>
<p>DatasetLinkCollection is the foundation for modular platform dataset architectures.
It orchestrates multiple specialized interpreter datasets, each handling a specific
subset of flags, and automatically routes fetch requests to the appropriate
interpreter. This is NOT used for linking scenarios (use DatasetConcatCollection
for that), but for linking interpreters within a single scenario/platform.</p>


<details class="architecture-pattern" open>
  <summary>Architecture Pattern</summary>
  <p>Platform datasets (PyPSADataset, PlexosDataset, etc.) are typically
implemented as DatasetLinkCollections containing specialized interpreters:</p>
<ul>
<li>
<p><strong>Core Platform Interpreters</strong>: Handle standard platform data</p>
<ul>
<li>ModelInterpreter: Static model data (generators, buses, lines, etc.)</li>
<li>TimeSeriesInterpreter: Time-varying data (generators_t.p, buses_t.marginal_price)</li>
<li>ObjectiveInterpreter: Optimization objective values</li>
<li>ConstraintInterpreters: Shadow prices, binding constraints</li>
</ul>
</li>
<li>
<p><strong>Study-Specific Interpreters</strong>: Extend or override platform behavior</p>
<ul>
<li>Custom variable interpreters: Derived metrics specific to the study</li>
<li>Correction interpreters: Override platform data with corrections</li>
<li>Integration interpreters: Combine external data sources</li>
</ul>
</li>
</ul>
</details>

<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li><strong>Automatic Flag Routing</strong>: Fetches are routed to the interpreter that accepts the flag</li>
<li><strong>Bidirectional Relationships</strong>: Each interpreter can access siblings via parent_dataset</li>
<li><strong>Separation of Concerns</strong>: Each interpreter specializes in one aspect of the data</li>
<li><strong>Study Extensibility</strong>: Add custom interpreters without modifying platform code</li>
<li><strong>First-Match Routing</strong>: First interpreter accepting a flag handles it</li>
<li><strong>Overlap Detection</strong>: Warns if multiple interpreters accept the same flag</li>
</ul>
</details>

<details class="routing-logic" open>
  <summary>Routing Logic</summary>
  <ol>
<li>User calls <code>platform_dataset.fetch('some_flag')</code></li>
<li>DatasetLinkCollection iterates through child interpreters in order</li>
<li>Returns data from first interpreter where <code>interpreter.flag_is_accepted('some_flag')</code></li>
<li>If no interpreter accepts the flag, raises KeyError</li>
</ol>
</details>

<details class="interpreter-communication" open>
  <summary>Interpreter Communication</summary>
  <p>Interpreters access sibling data through the parent_dataset property:</p>
<ul>
<li><code>self.parent_dataset.fetch('other_flag')</code> - Fetch from any sibling</li>
<li><code>self.parent_dataset.get_dataset_by_type(InterpreterClass)</code> - Access specific sibling</li>
<li><code>self.parent_dataset.attributes</code> - Access shared dataset attributes</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>Building a platform dataset with modular interpreters:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Standard platform dataset structure
&gt;&gt;&gt; class PyPSADataset(DatasetLinkCollection):
...     def __init__(self, network, name=None):
...         interpreters = [
...             PyPSAModelInterpreter(network),      # Handles: &#39;generators&#39;, &#39;buses&#39;, &#39;lines&#39;
...             PyPSATimeSeriesInterpreter(network),  # Handles: &#39;generators_t.p&#39;, &#39;buses_t.marginal_price&#39;
...             PyPSAObjectiveInterpreter(network),   # Handles: &#39;objective&#39;, &#39;total_cost&#39;
...         ]
...         super().__init__(datasets=interpreters, name=name)
...
...         # Set bidirectional parent-child links
...         for interpreter in interpreters:
...             interpreter.parent_dataset = self
&gt;&gt;&gt;
&gt;&gt;&gt; # Usage: transparent routing to correct interpreter
&gt;&gt;&gt; dataset = PyPSADataset(network, name=&#39;base_case&#39;)
&gt;&gt;&gt; buses = dataset.fetch(&#39;buses&#39;)                    # -&gt; PyPSAModelInterpreter
&gt;&gt;&gt; gen_p = dataset.fetch(&#39;generators_t.p&#39;)           # -&gt; PyPSATimeSeriesInterpreter
&gt;&gt;&gt; cost = dataset.fetch(&#39;objective&#39;)                 # -&gt; PyPSAObjectiveInterpreter
</code></pre></div>
<p>Study-specific extension with custom interpreter:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Study extends platform dataset with custom variables
&gt;&gt;&gt; class StudyDataset(PyPSADataset):
...     def __init__(self, network, name=None):
...         super().__init__(network, name)
...
...         # Add study-specific interpreter for derived metrics
...         custom_interpreter = RESGenerationInterpreter()
...         custom_interpreter.parent_dataset = self
...         self.add_dataset(custom_interpreter)
...
&gt;&gt;&gt; # Custom interpreter accesses platform interpreters via parent
&gt;&gt;&gt; class RESGenerationInterpreter(Dataset):
...     @property
...     def accepted_flags(self):
...         return {&#39;generators_t.res_generation_total&#39;}
...
...     def _fetch(self, flag, config, **kwargs):
...         # Access sibling interpreters through parent
...         gen_p = self.parent_dataset.fetch(&#39;generators_t.p&#39;)      # From TimeSeriesInterpreter
...         gen_model = self.parent_dataset.fetch(&#39;generators&#39;)       # From ModelInterpreter
...
...         # Calculate derived metric
...         res_gens = gen_model[gen_model[&#39;carrier&#39;].isin([&#39;solar&#39;, &#39;wind&#39;])]
...         return gen_p[res_gens.index].sum(axis=1)
</code></pre></div>
<p>Study-specific override of platform variable:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Study corrects platform data for specific scenarios
&gt;&gt;&gt; class CorrectedLineFlowsInterpreter(Dataset):
...     &#39;&#39;&#39;Override platform line flows with corrected external data.&#39;&#39;&#39;
...
...     @property
...     def accepted_flags(self):
...         return {&#39;Line.flow_net&#39;}  # Same flag as platform interpreter
...
...     def _fetch(self, flag, config, **kwargs):
...         # This interpreter is added BEFORE the previous platform interpreter,
...         # so it gets priority due to first-match routing
...
...         # Get original platform data from sibling
...         platform_interpreter = self.parent_dataset.get_dataset_by_type(
...             PlatformLineFlowInterpreter
...         )
...         flows = platform_interpreter.fetch(flag, config, **kwargs)
...
...         # Apply corrections for historical scenarios
...         if self.parent_dataset.attributes.get(&#39;replace_line_flow_with_custom_data&#39;):
...             flows = self._replace_line_flow_with_custom_data(flows)
...
...         return flows
...
&gt;&gt;&gt; # Add correction interpreter FIRST to override platform behavior
&gt;&gt;&gt; study_dataset = StudyDataset(network)
&gt;&gt;&gt; study_dataset.datasets.insert(0, CorrectedLineFlowsInterpreter())
</code></pre></div>
</details>

<details class="warning" open>
  <summary>Warning</summary>
  <p>If multiple child interpreters accept the same flag, only the FIRST one
in the datasets list will handle it. The constructor logs warnings for
such overlaps. This can be intentional (override pattern) or accidental.</p>
<p>To override a flag, add the overriding interpreter BEFORE the original
interpreter in the datasets list.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><code>Dataset.parent_dataset</code> - Property that child interpreters use to access parent</li>
<li><code>DatasetConcatCollection</code> - For linking multiple scenarios (different use case)</li>
<li><code>get_dataset_by_type()</code> - Method to access specific child interpreter by type</li>
</ul>
</details>







              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetLinkCollection</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">DatasetCollection</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Links specialized flag interpreters into a unified platform dataset interface.</span>

<span class="sd">    DatasetLinkCollection is the foundation for modular platform dataset architectures.</span>
<span class="sd">    It orchestrates multiple specialized interpreter datasets, each handling a specific</span>
<span class="sd">    subset of flags, and automatically routes fetch requests to the appropriate</span>
<span class="sd">    interpreter. This is NOT used for linking scenarios (use DatasetConcatCollection</span>
<span class="sd">    for that), but for linking interpreters within a single scenario/platform.</span>

<span class="sd">    Architecture Pattern:</span>
<span class="sd">        Platform datasets (PyPSADataset, PlexosDataset, etc.) are typically</span>
<span class="sd">        implemented as DatasetLinkCollections containing specialized interpreters:</span>

<span class="sd">        - **Core Platform Interpreters**: Handle standard platform data</span>
<span class="sd">            - ModelInterpreter: Static model data (generators, buses, lines, etc.)</span>
<span class="sd">            - TimeSeriesInterpreter: Time-varying data (generators_t.p, buses_t.marginal_price)</span>
<span class="sd">            - ObjectiveInterpreter: Optimization objective values</span>
<span class="sd">            - ConstraintInterpreters: Shadow prices, binding constraints</span>

<span class="sd">        - **Study-Specific Interpreters**: Extend or override platform behavior</span>
<span class="sd">            - Custom variable interpreters: Derived metrics specific to the study</span>
<span class="sd">            - Correction interpreters: Override platform data with corrections</span>
<span class="sd">            - Integration interpreters: Combine external data sources</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - **Automatic Flag Routing**: Fetches are routed to the interpreter that accepts the flag</span>
<span class="sd">        - **Bidirectional Relationships**: Each interpreter can access siblings via parent_dataset</span>
<span class="sd">        - **Separation of Concerns**: Each interpreter specializes in one aspect of the data</span>
<span class="sd">        - **Study Extensibility**: Add custom interpreters without modifying platform code</span>
<span class="sd">        - **First-Match Routing**: First interpreter accepting a flag handles it</span>
<span class="sd">        - **Overlap Detection**: Warns if multiple interpreters accept the same flag</span>

<span class="sd">    Routing Logic:</span>
<span class="sd">        1. User calls `platform_dataset.fetch(&#39;some_flag&#39;)`</span>
<span class="sd">        2. DatasetLinkCollection iterates through child interpreters in order</span>
<span class="sd">        3. Returns data from first interpreter where `interpreter.flag_is_accepted(&#39;some_flag&#39;)`</span>
<span class="sd">        4. If no interpreter accepts the flag, raises KeyError</span>

<span class="sd">    Interpreter Communication:</span>
<span class="sd">        Interpreters access sibling data through the parent_dataset property:</span>

<span class="sd">        - `self.parent_dataset.fetch(&#39;other_flag&#39;)` - Fetch from any sibling</span>
<span class="sd">        - `self.parent_dataset.get_dataset_by_type(InterpreterClass)` - Access specific sibling</span>
<span class="sd">        - `self.parent_dataset.attributes` - Access shared dataset attributes</span>

<span class="sd">    Example:</span>
<span class="sd">        Building a platform dataset with modular interpreters:</span>

<span class="sd">            &gt;&gt;&gt; # Standard platform dataset structure</span>
<span class="sd">            &gt;&gt;&gt; class PyPSADataset(DatasetLinkCollection):</span>
<span class="sd">            ...     def __init__(self, network, name=None):</span>
<span class="sd">            ...         interpreters = [</span>
<span class="sd">            ...             PyPSAModelInterpreter(network),      # Handles: &#39;generators&#39;, &#39;buses&#39;, &#39;lines&#39;</span>
<span class="sd">            ...             PyPSATimeSeriesInterpreter(network),  # Handles: &#39;generators_t.p&#39;, &#39;buses_t.marginal_price&#39;</span>
<span class="sd">            ...             PyPSAObjectiveInterpreter(network),   # Handles: &#39;objective&#39;, &#39;total_cost&#39;</span>
<span class="sd">            ...         ]</span>
<span class="sd">            ...         super().__init__(datasets=interpreters, name=name)</span>
<span class="sd">            ...</span>
<span class="sd">            ...         # Set bidirectional parent-child links</span>
<span class="sd">            ...         for interpreter in interpreters:</span>
<span class="sd">            ...             interpreter.parent_dataset = self</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Usage: transparent routing to correct interpreter</span>
<span class="sd">            &gt;&gt;&gt; dataset = PyPSADataset(network, name=&#39;base_case&#39;)</span>
<span class="sd">            &gt;&gt;&gt; buses = dataset.fetch(&#39;buses&#39;)                    # -&gt; PyPSAModelInterpreter</span>
<span class="sd">            &gt;&gt;&gt; gen_p = dataset.fetch(&#39;generators_t.p&#39;)           # -&gt; PyPSATimeSeriesInterpreter</span>
<span class="sd">            &gt;&gt;&gt; cost = dataset.fetch(&#39;objective&#39;)                 # -&gt; PyPSAObjectiveInterpreter</span>

<span class="sd">        Study-specific extension with custom interpreter:</span>

<span class="sd">            &gt;&gt;&gt; # Study extends platform dataset with custom variables</span>
<span class="sd">            &gt;&gt;&gt; class StudyDataset(PyPSADataset):</span>
<span class="sd">            ...     def __init__(self, network, name=None):</span>
<span class="sd">            ...         super().__init__(network, name)</span>
<span class="sd">            ...</span>
<span class="sd">            ...         # Add study-specific interpreter for derived metrics</span>
<span class="sd">            ...         custom_interpreter = RESGenerationInterpreter()</span>
<span class="sd">            ...         custom_interpreter.parent_dataset = self</span>
<span class="sd">            ...         self.add_dataset(custom_interpreter)</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; # Custom interpreter accesses platform interpreters via parent</span>
<span class="sd">            &gt;&gt;&gt; class RESGenerationInterpreter(Dataset):</span>
<span class="sd">            ...     @property</span>
<span class="sd">            ...     def accepted_flags(self):</span>
<span class="sd">            ...         return {&#39;generators_t.res_generation_total&#39;}</span>
<span class="sd">            ...</span>
<span class="sd">            ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">            ...         # Access sibling interpreters through parent</span>
<span class="sd">            ...         gen_p = self.parent_dataset.fetch(&#39;generators_t.p&#39;)      # From TimeSeriesInterpreter</span>
<span class="sd">            ...         gen_model = self.parent_dataset.fetch(&#39;generators&#39;)       # From ModelInterpreter</span>
<span class="sd">            ...</span>
<span class="sd">            ...         # Calculate derived metric</span>
<span class="sd">            ...         res_gens = gen_model[gen_model[&#39;carrier&#39;].isin([&#39;solar&#39;, &#39;wind&#39;])]</span>
<span class="sd">            ...         return gen_p[res_gens.index].sum(axis=1)</span>

<span class="sd">        Study-specific override of platform variable:</span>

<span class="sd">            &gt;&gt;&gt; # Study corrects platform data for specific scenarios</span>
<span class="sd">            &gt;&gt;&gt; class CorrectedLineFlowsInterpreter(Dataset):</span>
<span class="sd">            ...     &#39;&#39;&#39;Override platform line flows with corrected external data.&#39;&#39;&#39;</span>
<span class="sd">            ...</span>
<span class="sd">            ...     @property</span>
<span class="sd">            ...     def accepted_flags(self):</span>
<span class="sd">            ...         return {&#39;Line.flow_net&#39;}  # Same flag as platform interpreter</span>
<span class="sd">            ...</span>
<span class="sd">            ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">            ...         # This interpreter is added BEFORE the previous platform interpreter,</span>
<span class="sd">            ...         # so it gets priority due to first-match routing</span>
<span class="sd">            ...</span>
<span class="sd">            ...         # Get original platform data from sibling</span>
<span class="sd">            ...         platform_interpreter = self.parent_dataset.get_dataset_by_type(</span>
<span class="sd">            ...             PlatformLineFlowInterpreter</span>
<span class="sd">            ...         )</span>
<span class="sd">            ...         flows = platform_interpreter.fetch(flag, config, **kwargs)</span>
<span class="sd">            ...</span>
<span class="sd">            ...         # Apply corrections for historical scenarios</span>
<span class="sd">            ...         if self.parent_dataset.attributes.get(&#39;replace_line_flow_with_custom_data&#39;):</span>
<span class="sd">            ...             flows = self._replace_line_flow_with_custom_data(flows)</span>
<span class="sd">            ...</span>
<span class="sd">            ...         return flows</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; # Add correction interpreter FIRST to override platform behavior</span>
<span class="sd">            &gt;&gt;&gt; study_dataset = StudyDataset(network)</span>
<span class="sd">            &gt;&gt;&gt; study_dataset.datasets.insert(0, CorrectedLineFlowsInterpreter())</span>

<span class="sd">    Warning:</span>
<span class="sd">        If multiple child interpreters accept the same flag, only the FIRST one</span>
<span class="sd">        in the datasets list will handle it. The constructor logs warnings for</span>
<span class="sd">        such overlaps. This can be intentional (override pattern) or accidental.</span>

<span class="sd">        To override a flag, add the overriding interpreter BEFORE the original</span>
<span class="sd">        interpreter in the datasets list.</span>

<span class="sd">    See Also:</span>
<span class="sd">        - `Dataset.parent_dataset` - Property that child interpreters use to access parent</span>
<span class="sd">        - `DatasetConcatCollection` - For linking multiple scenarios (different use case)</span>
<span class="sd">        - `get_dataset_by_type()` - Method to access specific child interpreter by type</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">],</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">datasets</span><span class="o">=</span><span class="n">datasets</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="o">=</span><span class="n">parent_dataset</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="o">=</span><span class="n">flag_index</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_warn_if_flags_overlap</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">flag_is_accepted</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key &#39;</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#39; not recognized by any of the linked Datasets.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_warn_if_flags_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

        <span class="n">accepted_flags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="n">accepted_flags</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">accepted_flags</span><span class="p">)</span>

        <span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">accepted_flags</span><span class="p">)</span>
        <span class="n">duplicates</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">duplicates</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;The following keys have multiple Dataset sources: </span><span class="si">{</span><span class="n">duplicates</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">. </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Only the first one will be used! This might lead to unexpected behavior. </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;A potential reason could be the use of an inappropriate DatasetCollection Type.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Dataset</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns instance of child dataset that matches the ds_type.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_type</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">ds</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No Dataset of type </span><span class="si">{</span><span class="n">ds_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> found in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetLinkCollection.get_dataset_by_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_dataset_by_type</span>


<a href="#mesqual.datasets.DatasetLinkCollection.get_dataset_by_type" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_dataset_by_type</span><span class="p">(</span><span class="n">ds_type</span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            Dataset (mesqual.datasets.dataset.Dataset)" href="#mesqual.datasets.Dataset">Dataset</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="mesqual.typevars.DatasetType">DatasetType</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns instance of child dataset that matches the ds_type.</p>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Dataset</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns instance of child dataset that matches the ds_type.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_type</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ds</span>
    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No Dataset of type </span><span class="si">{</span><span class="n">ds_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> found in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetMergeCollection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetMergeCollection</span>


<a href="#mesqual.datasets.DatasetMergeCollection" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            DatasetCollection (mesqual.datasets.dataset_collection.DatasetCollection)" href="#mesqual.datasets.DatasetCollection">DatasetCollection</a>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code></p>


        <p>Fetch method will merge fragmented Datasets for same flag, e.g.:
    - fragmented simulation runs, e.g. CW1, CW2, CW3, CWn.
    - fragmented data sources, e.g. mapping from Excel file with model from simulation platform.</p>








              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetMergeCollection</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">DatasetCollection</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch method will merge fragmented Datasets for same flag, e.g.:</span>
<span class="sd">        - fragmented simulation runs, e.g. CW1, CW2, CW3, CWn.</span>
<span class="sd">        - fragmented data sources, e.g. mapping from Excel file with model from simulation platform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">],</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">keep_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">datasets</span><span class="o">=</span><span class="n">datasets</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="o">=</span><span class="n">parent_dataset</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="o">=</span><span class="n">flag_index</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep_first</span> <span class="o">=</span> <span class="n">keep_first</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">data_frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">flag_is_accepted</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                <span class="n">data_frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_frames</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flag &#39;</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#39; not recognized by any of the datasets.&quot;</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">mesqual.utils.pandas_utils.combine_df</span><span class="w"> </span><span class="kn">import</span> <span class="n">combine_dfs</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">combine_dfs</span><span class="p">(</span><span class="n">data_frames</span><span class="p">,</span> <span class="n">keep_first</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_first</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetConcatCollection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetConcatCollection</span>


<a href="#mesqual.datasets.DatasetConcatCollection" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            DatasetCollection (mesqual.datasets.dataset_collection.DatasetCollection)" href="#mesqual.datasets.DatasetCollection">DatasetCollection</a>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code></p>


        <p>Concatenates data from multiple datasets with MultiIndex structure.</p>
<p>DatasetConcatCollection is fundamental to MESQUAL's multi-scenario analysis
capabilities. It fetches the same flag from multiple child datasets and
concatenates the results into a single DataFrame/Series with an additional
index level identifying the source dataset.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Automatic MultiIndex creation with dataset names</li>
<li>Configurable concatenation axis and level positioning  </li>
<li>Preserves all dimensional relationships</li>
<li>Supports scenario and comparison collections</li>
<li>Enables unified analysis across multiple datasets</li>
</ul>
</details>

<details class="multiindex-structure" open>
  <summary>MultiIndex Structure</summary>
  <p>The resulting data structure includes an additional index level
(typically named 'dataset') that identifies the source dataset
for each data point.</p>
</details>        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Collection of scenario datasets
&gt;&gt;&gt; scenarios = DatasetConcatCollection([
...     PyPSADataset(base_network, name=&#39;base&#39;),
...     PyPSADataset(high_res_network, name=&#39;high_res&#39;),
...     PyPSADataset(low_gas_network, name=&#39;low_gas&#39;)
... ])
&gt;&gt;&gt; 
&gt;&gt;&gt; # Fetch creates MultiIndex DataFrame
&gt;&gt;&gt; prices = scenarios.fetch(&#39;buses_t.marginal_price&#39;)
&gt;&gt;&gt; print(prices.columns.names)
    [&#39;dataset&#39;, &#39;Bus&#39;]  # Original Bus index + dataset level
&gt;&gt;&gt; 
&gt;&gt;&gt; # Access specific scenario data
&gt;&gt;&gt; base_prices = prices[&#39;base&#39;]
&gt;&gt;&gt; 
&gt;&gt;&gt; # Analyze across scenarios
&gt;&gt;&gt; mean_prices = prices.mean()  # Mean across all scenarios
</code></pre></div>








              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_collection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetConcatCollection</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">DatasetCollection</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenates data from multiple datasets with MultiIndex structure.</span>

<span class="sd">    DatasetConcatCollection is fundamental to MESQUAL&#39;s multi-scenario analysis</span>
<span class="sd">    capabilities. It fetches the same flag from multiple child datasets and</span>
<span class="sd">    concatenates the results into a single DataFrame/Series with an additional</span>
<span class="sd">    index level identifying the source dataset.</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - Automatic MultiIndex creation with dataset names</span>
<span class="sd">        - Configurable concatenation axis and level positioning  </span>
<span class="sd">        - Preserves all dimensional relationships</span>
<span class="sd">        - Supports scenario and comparison collections</span>
<span class="sd">        - Enables unified analysis across multiple datasets</span>

<span class="sd">    MultiIndex Structure:</span>
<span class="sd">        The resulting data structure includes an additional index level</span>
<span class="sd">        (typically named &#39;dataset&#39;) that identifies the source dataset</span>
<span class="sd">        for each data point.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Collection of scenario datasets</span>
<span class="sd">        &gt;&gt;&gt; scenarios = DatasetConcatCollection([</span>
<span class="sd">        ...     PyPSADataset(base_network, name=&#39;base&#39;),</span>
<span class="sd">        ...     PyPSADataset(high_res_network, name=&#39;high_res&#39;),</span>
<span class="sd">        ...     PyPSADataset(low_gas_network, name=&#39;low_gas&#39;)</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Fetch creates MultiIndex DataFrame</span>
<span class="sd">        &gt;&gt;&gt; prices = scenarios.fetch(&#39;buses_t.marginal_price&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(prices.columns.names)</span>
<span class="sd">            [&#39;dataset&#39;, &#39;Bus&#39;]  # Original Bus index + dataset level</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Access specific scenario data</span>
<span class="sd">        &gt;&gt;&gt; base_prices = prices[&#39;base&#39;]</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Analyze across scenarios</span>
<span class="sd">        &gt;&gt;&gt; mean_prices = prices.mean()  # Mean across all scenarios</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DEFAULT_CONCAT_LEVEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;dataset&#39;</span>
    <span class="n">DEFAULT_ATT_LEVEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;attribute&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">],</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="p">:</span> <span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">default_concat_axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">concat_top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">concat_level_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">datasets</span><span class="o">=</span><span class="n">datasets</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">parent_dataset</span><span class="o">=</span><span class="n">parent_dataset</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="o">=</span><span class="n">flag_index</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="n">datasets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_concat_axis</span> <span class="o">=</span> <span class="n">default_concat_axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat_top</span> <span class="o">=</span> <span class="n">concat_top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat_level_name</span> <span class="o">=</span> <span class="n">concat_level_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_CONCAT_LEVEL_NAME</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_attributes_concat_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">DatasetConcatCollection</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">):</span>
            <span class="n">use_att_df_instead_of_series</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">use_att_df_instead_of_series</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">atts_per_dataset</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="n">atts</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_attributes_concat_df</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="k">if</span> <span class="n">use_att_df_instead_of_series</span> <span class="k">else</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_attributes_series</span><span class="p">()</span>
            <span class="n">atts_per_dataset</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">atts</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="n">atts_per_dataset</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">concat_level_name</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_ATT_LEVEL_NAME</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span>
            <span class="n">concat_axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">concat_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">concat_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_concat_axis</span>

        <span class="n">dfs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">flag_is_accepted</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                <span class="n">dfs</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dfs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flag &#39;</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#39; not recognized by any of the datasets in </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">df0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Axes lengths do not match between dfs.&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">axes</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Axes names do not match between dfs.&#39;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">concat_axis</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">concat_level_name</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_top</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">concat_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetComparison" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetComparison</span>


<a href="#mesqual.datasets.DatasetComparison" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            DatasetCollection (mesqual.datasets.dataset_collection.DatasetCollection)" href="#mesqual.datasets.DatasetCollection">DatasetCollection</a>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code></p>


        <p>Computes and provides access to differences between two datasets.</p>
<p>DatasetComparison is a core component of MESQUAL's scenario comparison capabilities.
It automatically calculates deltas, ratios, or side-by-side comparisons between
a variation dataset and a reference dataset, enabling systematic analysis of
scenario differences.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Automatic delta computation between datasets</li>
<li>Multiple comparison types (DELTA, VARIATION, BOTH)</li>
<li>Handles numeric and non-numeric data appropriately</li>
<li>Preserves data structure and index relationships</li>
<li>Configurable unchanged value handling</li>
<li>Inherits full Dataset interface</li>
</ul>
</details>

<details class="comparison-types" open>
  <summary>Comparison Types</summary>
  <ul>
<li>DELTA: Variation - Reference (default)</li>
<li>VARIATION: Returns variation data with optional NaN for unchanged values</li>
<li>BOTH: Side-by-side variation and reference data</li>
</ul>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetComparison.variation_dataset">variation_dataset</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset representing the scenario being compared</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetComparison.reference_dataset">reference_dataset</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset representing the baseline for comparison</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Compare high renewable scenario to base case
&gt;&gt;&gt; comparison = DatasetComparison(
...     variation_dataset=high_res_dataset,
...     reference_dataset=base_dataset
... )
&gt;&gt;&gt; 
&gt;&gt;&gt; # Get price differences
&gt;&gt;&gt; price_deltas = comparison.fetch(&#39;buses_t.marginal_price&#39;)
&gt;&gt;&gt; 
&gt;&gt;&gt; # Get both datasets side-by-side (often used to show model changes)
&gt;&gt;&gt; price_both = comparison.fetch(&#39;buses&#39;, comparison_type=ComparisonTypeEnum.BOTH)
&gt;&gt;&gt; 
&gt;&gt;&gt; # Highlight only changes (often used to show model changes)
&gt;&gt;&gt; price_changes = comparison.fetch(&#39;buses&#39;, replace_unchanged_values_by_nan=True)
</code></pre></div>








              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_comparison.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetComparison</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">DatasetCollection</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and provides access to differences between two datasets.</span>

<span class="sd">    DatasetComparison is a core component of MESQUAL&#39;s scenario comparison capabilities.</span>
<span class="sd">    It automatically calculates deltas, ratios, or side-by-side comparisons between</span>
<span class="sd">    a variation dataset and a reference dataset, enabling systematic analysis of</span>
<span class="sd">    scenario differences.</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - Automatic delta computation between datasets</span>
<span class="sd">        - Multiple comparison types (DELTA, VARIATION, BOTH)</span>
<span class="sd">        - Handles numeric and non-numeric data appropriately</span>
<span class="sd">        - Preserves data structure and index relationships</span>
<span class="sd">        - Configurable unchanged value handling</span>
<span class="sd">        - Inherits full Dataset interface</span>

<span class="sd">    Comparison Types:</span>
<span class="sd">        - DELTA: Variation - Reference (default)</span>
<span class="sd">        - VARIATION: Returns variation data with optional NaN for unchanged values</span>
<span class="sd">        - BOTH: Side-by-side variation and reference data</span>

<span class="sd">    Attributes:</span>
<span class="sd">        variation_dataset: The dataset representing the scenario being compared</span>
<span class="sd">        reference_dataset: The dataset representing the baseline for comparison</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Compare high renewable scenario to base case</span>
<span class="sd">        &gt;&gt;&gt; comparison = DatasetComparison(</span>
<span class="sd">        ...     variation_dataset=high_res_dataset,</span>
<span class="sd">        ...     reference_dataset=base_dataset</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Get price differences</span>
<span class="sd">        &gt;&gt;&gt; price_deltas = comparison.fetch(&#39;buses_t.marginal_price&#39;)</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Get both datasets side-by-side (often used to show model changes)</span>
<span class="sd">        &gt;&gt;&gt; price_both = comparison.fetch(&#39;buses&#39;, comparison_type=ComparisonTypeEnum.BOTH)</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Highlight only changes (often used to show model changes)</span>
<span class="sd">        &gt;&gt;&gt; price_changes = comparison.fetch(&#39;buses&#39;, replace_unchanged_values_by_nan=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">COMPARISON_ATTRIBUTES_SOURCE</span> <span class="o">=</span> <span class="n">ComparisonAttributesSourceEnum</span><span class="o">.</span><span class="n">USE_VARIATION_ATTS</span>
    <span class="n">COMPARISON_NAME_JOIN</span> <span class="o">=</span> <span class="s1">&#39; vs &#39;</span>
    <span class="n">VARIATION_DS_ATT_KEY</span> <span class="o">=</span> <span class="s1">&#39;variation_dataset&#39;</span>
    <span class="n">REFERENCE_DS_ATT_KEY</span> <span class="o">=</span> <span class="s1">&#39;reference_dataset&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">variation_dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
            <span class="n">reference_dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_auto_generated_name</span><span class="p">(</span><span class="n">variation_dataset</span><span class="p">,</span> <span class="n">reference_dataset</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="p">[</span><span class="n">reference_dataset</span><span class="p">,</span> <span class="n">variation_dataset</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">variation_dataset</span> <span class="o">=</span> <span class="n">variation_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reference_dataset</span> <span class="o">=</span> <span class="n">reference_dataset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_auto_generated_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variation_dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">reference_dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">variation_dataset</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">COMPARISON_NAME_JOIN</span> <span class="o">+</span> <span class="n">reference_dataset</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">COMPARISON_ATTRIBUTES_SOURCE</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ComparisonAttributesSourceEnum</span><span class="o">.</span><span class="n">USE_VARIATION_ATTS</span><span class="p">:</span>
                <span class="n">atts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variation_dataset</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">case</span> <span class="n">ComparisonAttributesSourceEnum</span><span class="o">.</span><span class="n">USE_REFERENCE_ATTS</span><span class="p">:</span>
                <span class="n">atts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_dataset</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">atts</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">attributes</span>
        <span class="n">atts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">VARIATION_DS_ATT_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variation_dataset</span><span class="o">.</span><span class="n">name</span>
        <span class="n">atts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">REFERENCE_DS_ATT_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_dataset</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">atts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fetch</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">comparison_type</span><span class="p">:</span> <span class="n">ComparisonTypeEnum</span> <span class="o">=</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">DELTA</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch comparison data between variation and reference datasets.</span>

<span class="sd">        Extends the base Dataset.fetch() method with comparison-specific parameters</span>
<span class="sd">        for controlling how the comparison is computed and formatted.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag: Data identifier flag to fetch from both datasets</span>
<span class="sd">            config: Optional configuration overrides</span>
<span class="sd">            comparison_type: How to compare the datasets:</span>
<span class="sd">                - DELTA: variation - reference (default)</span>
<span class="sd">                - VARIATION: variation data only, optionally with NaN for unchanged</span>
<span class="sd">                - BOTH: concatenated variation and reference data</span>
<span class="sd">            replace_unchanged_values_by_nan: If True, replaces values that are</span>
<span class="sd">                identical between datasets with NaN (useful for highlighting changes)</span>
<span class="sd">            fill_value: Value to use for missing data in subtraction operations</span>
<span class="sd">            **kwargs: Additional arguments passed to child dataset fetch methods</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame or Series with comparison results</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; # Basic delta comparison</span>
<span class="sd">            &gt;&gt;&gt; deltas = comparison.fetch(&#39;buses_t.marginal_price&#39;)</span>
<span class="sd">            &gt;&gt;&gt; </span>
<span class="sd">            &gt;&gt;&gt; # Highlight only changed values</span>
<span class="sd">            &gt;&gt;&gt; changes_only = comparison.fetch(</span>
<span class="sd">            ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">            ...     replace_unchanged_values_by_nan=True</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; </span>
<span class="sd">            &gt;&gt;&gt; # Side-by-side comparison</span>
<span class="sd">            &gt;&gt;&gt; both = comparison.fetch(</span>
<span class="sd">            ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">            ...     comparison_type=ComparisonTypeEnum.BOTH</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span>
            <span class="n">flag</span><span class="o">=</span><span class="n">flag</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">comparison_type</span><span class="o">=</span><span class="n">comparison_type</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="o">=</span><span class="n">replace_unchanged_values_by_nan</span><span class="p">,</span>
            <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
            <span class="n">effective_config</span><span class="p">:</span> <span class="n">DatasetConfigType</span><span class="p">,</span>
            <span class="n">comparison_type</span><span class="p">:</span> <span class="n">ComparisonTypeEnum</span> <span class="o">=</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">DELTA</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">df_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variation_dataset</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">df_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_dataset</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">effective_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">match</span> <span class="n">comparison_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">VARIATION</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_variation_comparison</span><span class="p">(</span><span class="n">df_var</span><span class="p">,</span> <span class="n">df_ref</span><span class="p">,</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">BOTH</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_both_comparison</span><span class="p">(</span><span class="n">df_var</span><span class="p">,</span> <span class="n">df_ref</span><span class="p">,</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">DELTA</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_delta_comparison</span><span class="p">(</span><span class="n">df_var</span><span class="p">,</span> <span class="n">df_ref</span><span class="p">,</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported comparison_type: </span><span class="si">{</span><span class="n">comparison_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_values_are_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val1</span> <span class="o">==</span> <span class="n">val2</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">val2</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_variation_comparison</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">df_var</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">df_ref</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
            <span class="n">common_indices</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">common_columns</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">common_indices</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">common_columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values_are_equal</span><span class="p">(</span><span class="n">df_var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_both_comparison</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">df_var</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">df_ref</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variation_dataset</span><span class="o">.</span><span class="n">name</span>
        <span class="n">ref_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_dataset</span><span class="o">.</span><span class="n">name</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_var</span><span class="p">,</span> <span class="n">df_ref</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="n">var_name</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
            <span class="n">common_indices</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">common_columns</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">common_indices</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">common_columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values_are_equal</span><span class="p">(</span><span class="n">df_var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ref_name</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_delta_comparison</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">df_var</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">df_ref</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
            <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pd_is_numeric</span><span class="p">(</span><span class="n">df_var</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pd_is_numeric</span><span class="p">(</span><span class="n">df_ref</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">df_ref</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="n">all_columns</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">all_indices</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">all_indices</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">all_columns</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_var</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">var_col</span> <span class="o">=</span> <span class="n">df_var</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">ref_col</span> <span class="o">=</span> <span class="n">df_ref</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

                <span class="c1"># Special handling for boolean columns</span>
                <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">var_col</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">ref_col</span><span class="p">):</span>
                    <span class="c1"># For booleans, we can mark where they differ</span>
                    <span class="n">common_indices</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">delta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">all_indices</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">common_indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                            <span class="n">delta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> (was </span><span class="si">{</span><span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
                            <span class="n">delta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

                    <span class="c1"># Handle indices only in variation</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                        <span class="n">delta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> (new)&quot;</span>

                    <span class="c1"># Handle indices only in reference</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                        <span class="n">delta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DELETED: </span><span class="si">{</span><span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

                    <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>

                <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">var_col</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">ref_col</span><span class="p">):</span>
                    <span class="n">delta</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">ref_col</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>

                    <span class="k">if</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">delta</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">common_indices</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">var_only_indices</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">ref_only_indices</span> <span class="o">=</span> <span class="n">ref_col</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">var_col</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">common_indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values_are_equal</span><span class="p">(</span><span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]):</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> (was </span><span class="si">{</span><span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">var_only_indices</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> (new)&quot;</span>

                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">ref_only_indices</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">ref_col</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DELETED: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">elif</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_var</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">df_var</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df_var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">]</span><span class="si">}</span><span class="s2"> (new column)&quot;</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Column only in reference</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;REMOVED: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetComparison.fetch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fetch</span>


<a href="#mesqual.datasets.DatasetComparison.fetch" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fetch</span><span class="p">(</span><span class="n">flag</span><span class="p">:</span> <span class="n"><span title="mesqual.typevars.FlagType">FlagType</span></span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">comparison_type</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ComparisonTypeEnum (mesqual.enums.ComparisonTypeEnum)" href="../enums/#mesqual.enums.ComparisonTypeEnum">ComparisonTypeEnum</a></span> <span class="o">=</span> <span class="n"><span title="mesqual.enums.ComparisonTypeEnum.DELTA">DELTA</span></span><span class="p">,</span> <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span> <span class="o">|</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fetch comparison data between variation and reference datasets.</p>
<p>Extends the base Dataset.fetch() method with comparison-specific parameters
for controlling how the comparison is computed and formatted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flag</code>
            </td>
            <td>
                  <code><span title="mesqual.typevars.FlagType">FlagType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data identifier flag to fetch from both datasets</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional configuration overrides</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>comparison_type</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ComparisonTypeEnum (mesqual.enums.ComparisonTypeEnum)" href="../enums/#mesqual.enums.ComparisonTypeEnum">ComparisonTypeEnum</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to compare the datasets:
- DELTA: variation - reference (default)
- VARIATION: variation data only, optionally with NaN for unchanged
- BOTH: concatenated variation and reference data</p>
              </div>
            </td>
            <td>
                  <code><span title="mesqual.enums.ComparisonTypeEnum.DELTA">DELTA</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>replace_unchanged_values_by_nan</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, replaces values that are
identical between datasets with NaN (useful for highlighting changes)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_value</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to use for missing data in subtraction operations</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to child dataset fetch methods</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame or Series with comparison results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Basic delta comparison
&gt;&gt;&gt; deltas = comparison.fetch(&#39;buses_t.marginal_price&#39;)
&gt;&gt;&gt; 
&gt;&gt;&gt; # Highlight only changed values
&gt;&gt;&gt; changes_only = comparison.fetch(
...     &#39;buses_t.marginal_price&#39;,
...     replace_unchanged_values_by_nan=True
... )
&gt;&gt;&gt; 
&gt;&gt;&gt; # Side-by-side comparison
&gt;&gt;&gt; both = comparison.fetch(
...     &#39;buses_t.marginal_price&#39;,
...     comparison_type=ComparisonTypeEnum.BOTH
... )
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_comparison.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flag</span><span class="p">:</span> <span class="n">FlagType</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">comparison_type</span><span class="p">:</span> <span class="n">ComparisonTypeEnum</span> <span class="o">=</span> <span class="n">ComparisonTypeEnum</span><span class="o">.</span><span class="n">DELTA</span><span class="p">,</span>
        <span class="n">replace_unchanged_values_by_nan</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch comparison data between variation and reference datasets.</span>

<span class="sd">    Extends the base Dataset.fetch() method with comparison-specific parameters</span>
<span class="sd">    for controlling how the comparison is computed and formatted.</span>

<span class="sd">    Args:</span>
<span class="sd">        flag: Data identifier flag to fetch from both datasets</span>
<span class="sd">        config: Optional configuration overrides</span>
<span class="sd">        comparison_type: How to compare the datasets:</span>
<span class="sd">            - DELTA: variation - reference (default)</span>
<span class="sd">            - VARIATION: variation data only, optionally with NaN for unchanged</span>
<span class="sd">            - BOTH: concatenated variation and reference data</span>
<span class="sd">        replace_unchanged_values_by_nan: If True, replaces values that are</span>
<span class="sd">            identical between datasets with NaN (useful for highlighting changes)</span>
<span class="sd">        fill_value: Value to use for missing data in subtraction operations</span>
<span class="sd">        **kwargs: Additional arguments passed to child dataset fetch methods</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame or Series with comparison results</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Basic delta comparison</span>
<span class="sd">        &gt;&gt;&gt; deltas = comparison.fetch(&#39;buses_t.marginal_price&#39;)</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Highlight only changed values</span>
<span class="sd">        &gt;&gt;&gt; changes_only = comparison.fetch(</span>
<span class="sd">        ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">        ...     replace_unchanged_values_by_nan=True</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Side-by-side comparison</span>
<span class="sd">        &gt;&gt;&gt; both = comparison.fetch(</span>
<span class="sd">        ...     &#39;buses_t.marginal_price&#39;,</span>
<span class="sd">        ...     comparison_type=ComparisonTypeEnum.BOTH</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span>
        <span class="n">flag</span><span class="o">=</span><span class="n">flag</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">comparison_type</span><span class="o">=</span><span class="n">comparison_type</span><span class="p">,</span>
        <span class="n">replace_unchanged_values_by_nan</span><span class="o">=</span><span class="n">replace_unchanged_values_by_nan</span><span class="p">,</span>
        <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.PlatformDataset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PlatformDataset</span>


<a href="#mesqual.datasets.PlatformDataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><a class="autorefs autorefs-internal" title="            DatasetLinkCollection (mesqual.datasets.dataset_collection.DatasetLinkCollection)" href="#mesqual.datasets.DatasetLinkCollection">DatasetLinkCollection</a>[<span title="mesqual.typevars.DatasetType">DatasetType</span>, <span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span>, <span title="mesqual.typevars.FlagType">FlagType</span>, <span title="mesqual.typevars.FlagIndexType">FlagIndexType</span>]</code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for platform-specific datasets with automatic interpreter management.</p>
<p>PlatformDataset provides the foundation for integrating MESQUAL with specific
energy modeling platforms (PyPSA, PLEXOS, etc.). It manages a registry of
data interpreters and automatically instantiates them to handle different
types of platform data.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Automatic interpreter registration and instantiation</li>
<li>Type-safe interpreter management through generics</li>
<li>Flexible argument passing to interpreter constructors</li>
<li>Support for study-specific interpreter extensions</li>
<li>Unified data access through DatasetLinkCollection routing</li>
</ul>
</details>

<details class="architecture" open>
  <summary>Architecture</summary>
  <ul>
<li>Uses DatasetLinkCollection for automatic flag routing</li>
<li>Manages interpreter registry at class level</li>
<li>Auto-instantiates all registered interpreters on construction</li>
<li>Supports inheritance and interpreter registration on subclasses</li>
</ul>
</details>

<p>
      <span class="doc-section-title">
        Class Type Parameters:
      </span>
    </p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Bound or Constraints</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DatasetType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base type for all interpreters (must be Dataset subclass)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>DatasetConfigType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration class for dataset behavior</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type used for data flag identification</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>FlagIndexType</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag index implementation for flag mapping</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="class-attributes" open>
  <summary>Class Attributes</summary>
  <p>_interpreter_registry: List of registered interpreter classes</p>
</details>

<details class="usage-pattern" open>
  <summary>Usage Pattern</summary>
  <ol>
<li>Create platform dataset class inheriting from PlatformDataset</li>
<li>Define get_child_dataset_type() to specify interpreter base class</li>
<li>Create interpreter classes inheriting from the base interpreter</li>
<li>Register interpreters using @PlatformDataset.register_interpreter</li>
<li>Instantiate platform dataset - interpreters are auto-created</li>
</ol>
</details>        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Define platform dataset
&gt;&gt;&gt; class PyPSADataset(PlatformDataset[PyPSAInterpreter, ...]):
...     @classmethod
...     def get_child_dataset_type(cls):
...         return PyPSAInterpreter
...
&gt;&gt;&gt; # Register core interpreters
&gt;&gt;&gt; @PyPSADataset.register_interpreter
... class PyPSAModelInterpreter(PyPSAInterpreter):
...     @property
...     def accepted_flags(self):
...         return {&#39;buses&#39;, &#39;generators&#39;, &#39;lines&#39;}
...
&gt;&gt;&gt; @PyPSADataset.register_interpreter  
... class PyPSATimeSeriesInterpreter(PyPSAInterpreter):
...     @property
...     def accepted_flags(self):
...         return {&#39;buses_t.marginal_price&#39;, &#39;generators_t.p&#39;}
...
&gt;&gt;&gt; # Register study-specific interpreter
&gt;&gt;&gt; @PyPSADataset.register_interpreter
... class CustomVariableInterpreter(PyPSAInterpreter):
...     @property
...     def accepted_flags(self):
...         return {&#39;custom_metric&#39;}
...
&gt;&gt;&gt; # Use platform dataset
&gt;&gt;&gt; dataset = PyPSADataset(network=my_network)
&gt;&gt;&gt; buses = dataset.fetch(&#39;buses&#39;)  # Routes to ModelInterpreter
&gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)  # Routes to TimeSeriesInterpreter
&gt;&gt;&gt; custom = dataset.fetch(&#39;custom_metric&#39;)  # Routes to CustomVariableInterpreter
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Interpreters are registered at class level and shared across instances</li>
<li>Registration order affects routing (last registered = first checked)</li>
<li>All registered interpreters are instantiated for each platform dataset</li>
<li>Constructor arguments are automatically extracted and passed to interpreters</li>
</ul>
</details>







              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/platform_dataset.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlatformDataset</span><span class="p">(</span>
    <span class="n">Generic</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">DatasetLinkCollection</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">,</span> <span class="n">DatasetConfigType</span><span class="p">,</span> <span class="n">FlagType</span><span class="p">,</span> <span class="n">FlagIndexType</span><span class="p">],</span>
    <span class="n">ABC</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for platform-specific datasets with automatic interpreter management.</span>

<span class="sd">    PlatformDataset provides the foundation for integrating MESQUAL with specific</span>
<span class="sd">    energy modeling platforms (PyPSA, PLEXOS, etc.). It manages a registry of</span>
<span class="sd">    data interpreters and automatically instantiates them to handle different</span>
<span class="sd">    types of platform data.</span>

<span class="sd">    Key Features:</span>
<span class="sd">        - Automatic interpreter registration and instantiation</span>
<span class="sd">        - Type-safe interpreter management through generics</span>
<span class="sd">        - Flexible argument passing to interpreter constructors</span>
<span class="sd">        - Support for study-specific interpreter extensions</span>
<span class="sd">        - Unified data access through DatasetLinkCollection routing</span>

<span class="sd">    Architecture:</span>
<span class="sd">        - Uses DatasetLinkCollection for automatic flag routing</span>
<span class="sd">        - Manages interpreter registry at class level</span>
<span class="sd">        - Auto-instantiates all registered interpreters on construction</span>
<span class="sd">        - Supports inheritance and interpreter registration on subclasses</span>

<span class="sd">    Type Parameters:</span>
<span class="sd">        DatasetType: Base type for all interpreters (must be Dataset subclass)</span>
<span class="sd">        DatasetConfigType: Configuration class for dataset behavior</span>
<span class="sd">        FlagType: Type used for data flag identification</span>
<span class="sd">        FlagIndexType: Flag index implementation for flag mapping</span>

<span class="sd">    Class Attributes:</span>
<span class="sd">        _interpreter_registry: List of registered interpreter classes</span>

<span class="sd">    Usage Pattern:</span>
<span class="sd">        1. Create platform dataset class inheriting from PlatformDataset</span>
<span class="sd">        2. Define get_child_dataset_type() to specify interpreter base class</span>
<span class="sd">        3. Create interpreter classes inheriting from the base interpreter</span>
<span class="sd">        4. Register interpreters using @PlatformDataset.register_interpreter</span>
<span class="sd">        5. Instantiate platform dataset - interpreters are auto-created</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; # Define platform dataset</span>
<span class="sd">        &gt;&gt;&gt; class PyPSADataset(PlatformDataset[PyPSAInterpreter, ...]):</span>
<span class="sd">        ...     @classmethod</span>
<span class="sd">        ...     def get_child_dataset_type(cls):</span>
<span class="sd">        ...         return PyPSAInterpreter</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; # Register core interpreters</span>
<span class="sd">        &gt;&gt;&gt; @PyPSADataset.register_interpreter</span>
<span class="sd">        ... class PyPSAModelInterpreter(PyPSAInterpreter):</span>
<span class="sd">        ...     @property</span>
<span class="sd">        ...     def accepted_flags(self):</span>
<span class="sd">        ...         return {&#39;buses&#39;, &#39;generators&#39;, &#39;lines&#39;}</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; @PyPSADataset.register_interpreter  </span>
<span class="sd">        ... class PyPSATimeSeriesInterpreter(PyPSAInterpreter):</span>
<span class="sd">        ...     @property</span>
<span class="sd">        ...     def accepted_flags(self):</span>
<span class="sd">        ...         return {&#39;buses_t.marginal_price&#39;, &#39;generators_t.p&#39;}</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; # Register study-specific interpreter</span>
<span class="sd">        &gt;&gt;&gt; @PyPSADataset.register_interpreter</span>
<span class="sd">        ... class CustomVariableInterpreter(PyPSAInterpreter):</span>
<span class="sd">        ...     @property</span>
<span class="sd">        ...     def accepted_flags(self):</span>
<span class="sd">        ...         return {&#39;custom_metric&#39;}</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; # Use platform dataset</span>
<span class="sd">        &gt;&gt;&gt; dataset = PyPSADataset(network=my_network)</span>
<span class="sd">        &gt;&gt;&gt; buses = dataset.fetch(&#39;buses&#39;)  # Routes to ModelInterpreter</span>
<span class="sd">        &gt;&gt;&gt; prices = dataset.fetch(&#39;buses_t.marginal_price&#39;)  # Routes to TimeSeriesInterpreter</span>
<span class="sd">        &gt;&gt;&gt; custom = dataset.fetch(&#39;custom_metric&#39;)  # Routes to CustomVariableInterpreter</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Interpreters are registered at class level and shared across instances</span>
<span class="sd">        - Registration order affects routing (last registered = first checked)</span>
<span class="sd">        - All registered interpreters are instantiated for each platform dataset</span>
<span class="sd">        - Constructor arguments are automatically extracted and passed to interpreters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_interpreter_registry</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="p">:</span> <span class="n">FlagIndexType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="p">:</span> <span class="n">Database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">DatasetConfigType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">datasets</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">flag_index</span><span class="o">=</span><span class="n">flag_index</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">interpreter_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_interpreter_initialization_args</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_registered_interpreters</span><span class="p">(</span><span class="n">interpreter_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_datasets</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_interpreter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s1">&#39;DatasetType&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a data interpreter class with this platform dataset.</span>

<span class="sd">        This method is typically used as a decorator to register interpreter classes</span>
<span class="sd">        that handle specific types of platform data. Registered interpreters are</span>
<span class="sd">        automatically instantiated when the platform dataset is created.</span>

<span class="sd">        Args:</span>
<span class="sd">            interpreter: Interpreter class that must inherit from get_child_dataset_type()</span>

<span class="sd">        Returns:</span>
<span class="sd">            The interpreter class (unchanged) to support decorator usage</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If interpreter doesn&#39;t inherit from the required base class</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; @PyPSADataset.register_interpreter</span>
<span class="sd">            ... class CustomInterpreter(PyPSAInterpreter):</span>
<span class="sd">            ...     @property</span>
<span class="sd">            ...     def accepted_flags(self):</span>
<span class="sd">            ...         return {&#39;custom_flag&#39;}</span>
<span class="sd">            ...     </span>
<span class="sd">            ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">            ...         return compute_custom_data()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_interpreter_type</span><span class="p">(</span><span class="n">interpreter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">interpreter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interpreter_registry</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_add_interpreter_to_registry</span><span class="p">(</span><span class="n">interpreter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interpreter</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_registered_interpreters</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interpreter_registry</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_interpreter_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpreter_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetType</span><span class="p">:</span>
        <span class="n">interpreter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_interpreter_instance</span><span class="p">(</span><span class="n">interpreter_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">interpreter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;No interpreter instance found for type </span><span class="si">{</span><span class="n">interpreter_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">interpreter</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_flags_by_interpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">],</span> <span class="nb">set</span><span class="p">[</span><span class="n">FlagType</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">interpreter</span><span class="p">):</span> <span class="n">interpreter</span><span class="o">.</span><span class="n">accepted_flags</span>
            <span class="k">for</span> <span class="n">interpreter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_interpreter_initialization_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">interpreter_signature</span> <span class="o">=</span> <span class="n">InterpreterSignature</span><span class="o">.</span><span class="n">from_interpreter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_child_dataset_type</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">arg</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">default</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">interpreter_signature</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="n">interpreter_signature</span><span class="o">.</span><span class="n">defaults</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_registered_interpreters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpreter_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">interpreter</span><span class="p">(</span><span class="o">**</span><span class="n">interpreter_args</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">interpreter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpreter_registry</span>
        <span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_interpreter_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">interpreter</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_child_dataset_type</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Interpreter must be subclass of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_child_dataset_type</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_interpreter_not_registered</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interpreter</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interpreter_registry</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Interpreter </span><span class="si">{</span><span class="n">interpreter</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> already registered&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_add_interpreter_to_registry</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_interpreter_registry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_interpreter_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpreter_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">interpreter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interpreter</span><span class="p">,</span> <span class="n">interpreter_type</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">interpreter</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.PlatformDataset.register_interpreter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">register_interpreter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mesqual.datasets.PlatformDataset.register_interpreter" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">register_interpreter</span><span class="p">(</span><span class="n">interpreter</span><span class="p">:</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.DatasetType">DatasetType</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="s1">&#39;DatasetType&#39;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Register a data interpreter class with this platform dataset.</p>
<p>This method is typically used as a decorator to register interpreter classes
that handle specific types of platform data. Registered interpreters are
automatically instantiated when the platform dataset is created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>interpreter</code>
            </td>
            <td>
                  <code><span title="typing.Type">Type</span>[<span title="mesqual.typevars.DatasetType">DatasetType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interpreter class that must inherit from get_child_dataset_type()</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Type">Type</span>[&#39;DatasetType&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpreter class (unchanged) to support decorator usage</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If interpreter doesn't inherit from the required base class</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; @PyPSADataset.register_interpreter
... class CustomInterpreter(PyPSAInterpreter):
...     @property
...     def accepted_flags(self):
...         return {&#39;custom_flag&#39;}
...     
...     def _fetch(self, flag, config, **kwargs):
...         return compute_custom_data()
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/platform_dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_interpreter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DatasetType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s1">&#39;DatasetType&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a data interpreter class with this platform dataset.</span>

<span class="sd">    This method is typically used as a decorator to register interpreter classes</span>
<span class="sd">    that handle specific types of platform data. Registered interpreters are</span>
<span class="sd">    automatically instantiated when the platform dataset is created.</span>

<span class="sd">    Args:</span>
<span class="sd">        interpreter: Interpreter class that must inherit from get_child_dataset_type()</span>

<span class="sd">    Returns:</span>
<span class="sd">        The interpreter class (unchanged) to support decorator usage</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If interpreter doesn&#39;t inherit from the required base class</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; @PyPSADataset.register_interpreter</span>
<span class="sd">        ... class CustomInterpreter(PyPSAInterpreter):</span>
<span class="sd">        ...     @property</span>
<span class="sd">        ...     def accepted_flags(self):</span>
<span class="sd">        ...         return {&#39;custom_flag&#39;}</span>
<span class="sd">        ...     </span>
<span class="sd">        ...     def _fetch(self, flag, config, **kwargs):</span>
<span class="sd">        ...         return compute_custom_data()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_interpreter_type</span><span class="p">(</span><span class="n">interpreter</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">interpreter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interpreter_registry</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_add_interpreter_to_registry</span><span class="p">(</span><span class="n">interpreter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">interpreter</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="mesqual.datasets.DatasetConfig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DatasetConfig</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#mesqual.datasets.DatasetConfig" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Base configuration class for controlling Dataset behavior.</p>
<p>DatasetConfig provides common configuration options that apply to all datasets
in the MESQUAL framework. Platform-specific and study-specific configurations
should extend this class to add additional options.</p>
<p>The configuration system uses a merge-based hierarchy where each level can
override settings from the previous level. The :meth:<code>merge</code> method combines
configurations, with later values taking precedence over earlier ones.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetConfig.use_database">use_database</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, enables database caching for expensive fetch
operations. When a database is configured on the dataset, fetched
data will be cached and retrieved from cache on subsequent calls.
Set to False to bypass caching. Default: True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetConfig.auto_sort_datetime_index">auto_sort_datetime_index</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, automatically sorts the returned
DataFrame/Series by its DatetimeIndex after fetching. This ensures
time-series data is always in chronological order regardless of
the source data ordering. Default: True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mesqual.datasets.DatasetConfig.remove_duplicate_indices">remove_duplicate_indices</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, automatically removes duplicate
index entries from fetched data, keeping the first occurrence.
A warning is logged when duplicates are found. This protects
against data quality issues in source data. Default: True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Creating a custom configuration::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; config = DatasetConfig(use_database=False)
&gt;&gt;&gt; dataset = MyDataset(config=config)
</code></pre></div>
<p>Extending for platform-specific options::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; @dataclass
... class MyPlatformConfig(DatasetConfig):
...     custom_option: bool = True
...     date_filter: list = None
</code></pre></div>
</details>







              <details class="quote">
                <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatasetConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base configuration class for controlling Dataset behavior.</span>

<span class="sd">    DatasetConfig provides common configuration options that apply to all datasets</span>
<span class="sd">    in the MESQUAL framework. Platform-specific and study-specific configurations</span>
<span class="sd">    should extend this class to add additional options.</span>

<span class="sd">    The configuration system uses a merge-based hierarchy where each level can</span>
<span class="sd">    override settings from the previous level. The :meth:`merge` method combines</span>
<span class="sd">    configurations, with later values taking precedence over earlier ones.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        use_database: If True, enables database caching for expensive fetch</span>
<span class="sd">            operations. When a database is configured on the dataset, fetched</span>
<span class="sd">            data will be cached and retrieved from cache on subsequent calls.</span>
<span class="sd">            Set to False to bypass caching. Default: True.</span>

<span class="sd">        auto_sort_datetime_index: If True, automatically sorts the returned</span>
<span class="sd">            DataFrame/Series by its DatetimeIndex after fetching. This ensures</span>
<span class="sd">            time-series data is always in chronological order regardless of</span>
<span class="sd">            the source data ordering. Default: True.</span>

<span class="sd">        remove_duplicate_indices: If True, automatically removes duplicate</span>
<span class="sd">            index entries from fetched data, keeping the first occurrence.</span>
<span class="sd">            A warning is logged when duplicates are found. This protects</span>
<span class="sd">            against data quality issues in source data. Default: True.</span>

<span class="sd">    Example:</span>
<span class="sd">        Creating a custom configuration::</span>

<span class="sd">            &gt;&gt;&gt; config = DatasetConfig(use_database=False)</span>
<span class="sd">            &gt;&gt;&gt; dataset = MyDataset(config=config)</span>

<span class="sd">        Extending for platform-specific options::</span>

<span class="sd">            &gt;&gt;&gt; @dataclass</span>
<span class="sd">            ... class MyPlatformConfig(DatasetConfig):</span>
<span class="sd">            ...     custom_option: bool = True</span>
<span class="sd">            ...     date_filter: list = None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">use_database</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">auto_sort_datetime_index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">remove_duplicate_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetConfigType</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetConfigType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge this configuration with another, returning a new combined config.</span>

<span class="sd">        Creates a new configuration instance that combines settings from both</span>
<span class="sd">        configurations. Values from ``other`` override values from ``self``,</span>
<span class="sd">        but only for non-None values. This allows partial overrides where you</span>
<span class="sd">        only specify the settings you want to change.</span>

<span class="sd">        The merge creates a new instance of the same type as ``self``, ensuring</span>
<span class="sd">        that subclass-specific attributes are preserved.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Configuration to merge with. Can be:</span>
<span class="sd">                - None: Returns self unchanged</span>
<span class="sd">                - dict: Keys map to config attribute names</span>
<span class="sd">                - DatasetConfig: Another config instance (same or subclass)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new configuration instance combining both configs. The return</span>
<span class="sd">            type matches the type of ``self``.</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; base = DatasetConfig(use_database=True, auto_sort_datetime_index=True)</span>
<span class="sd">            &gt;&gt;&gt; override = DatasetConfig(use_database=False)</span>
<span class="sd">            &gt;&gt;&gt; merged = base.merge(override)</span>
<span class="sd">            &gt;&gt;&gt; merged.use_database</span>
<span class="sd">                False</span>
<span class="sd">            &gt;&gt;&gt; merged.auto_sort_datetime_index  # Preserved from base</span>
<span class="sd">                True</span>

<span class="sd">            Using a dict for quick overrides:</span>

<span class="sd">                &gt;&gt;&gt; merged = base.merge({&#39;use_database&#39;: False})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">merged_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>  <span class="c1"># Skip private attributes</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">merged_config</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">other_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">other_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">other_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">merged_config</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation showing all config attributes.&quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">attrs</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetConfig.merge" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">merge</span>


<a href="#mesqual.datasets.DatasetConfig.merge" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span> <span class="o">|</span> <span class="n"><span title="dict">dict</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge this configuration with another, returning a new combined config.</p>
<p>Creates a new configuration instance that combines settings from both
configurations. Values from <code>other</code> override values from <code>self</code>,
but only for non-None values. This allows partial overrides where you
only specify the settings you want to change.</p>
<p>The merge creates a new instance of the same type as <code>self</code>, ensuring
that subclass-specific attributes are preserved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span> | <span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration to merge with. Can be:
- None: Returns self unchanged
- dict: Keys map to config attribute names
- DatasetConfig: Another config instance (same or subclass)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new configuration instance combining both configs. The return</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="mesqual.typevars.DatasetConfigType">DatasetConfigType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type matches the type of <code>self</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; base = DatasetConfig(use_database=True, auto_sort_datetime_index=True)
&gt;&gt;&gt; override = DatasetConfig(use_database=False)
&gt;&gt;&gt; merged = base.merge(override)
&gt;&gt;&gt; merged.use_database
    False
&gt;&gt;&gt; merged.auto_sort_datetime_index  # Preserved from base
    True

Using a dict for quick overrides:

    &gt;&gt;&gt; merged = base.merge({&#39;use_database&#39;: False})
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetConfigType</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DatasetConfigType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge this configuration with another, returning a new combined config.</span>

<span class="sd">    Creates a new configuration instance that combines settings from both</span>
<span class="sd">    configurations. Values from ``other`` override values from ``self``,</span>
<span class="sd">    but only for non-None values. This allows partial overrides where you</span>
<span class="sd">    only specify the settings you want to change.</span>

<span class="sd">    The merge creates a new instance of the same type as ``self``, ensuring</span>
<span class="sd">    that subclass-specific attributes are preserved.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Configuration to merge with. Can be:</span>
<span class="sd">            - None: Returns self unchanged</span>
<span class="sd">            - dict: Keys map to config attribute names</span>
<span class="sd">            - DatasetConfig: Another config instance (same or subclass)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new configuration instance combining both configs. The return</span>
<span class="sd">        type matches the type of ``self``.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; base = DatasetConfig(use_database=True, auto_sort_datetime_index=True)</span>
<span class="sd">        &gt;&gt;&gt; override = DatasetConfig(use_database=False)</span>
<span class="sd">        &gt;&gt;&gt; merged = base.merge(override)</span>
<span class="sd">        &gt;&gt;&gt; merged.use_database</span>
<span class="sd">            False</span>
<span class="sd">        &gt;&gt;&gt; merged.auto_sort_datetime_index  # Preserved from base</span>
<span class="sd">            True</span>

<span class="sd">        Using a dict for quick overrides:</span>

<span class="sd">            &gt;&gt;&gt; merged = base.merge({&#39;use_database&#39;: False})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="n">merged_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>  <span class="c1"># Skip private attributes</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">merged_config</span>

    <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
            <span class="n">other_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">merged_config</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">other_value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged_config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesqual.datasets.DatasetConfig.__repr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__repr__</span>


<a href="#mesqual.datasets.DatasetConfig.__repr__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a string representation showing all config attributes.</p>


            <details class="quote">
              <summary>Source code in <code>submodules/mesqual/mesqual/datasets/dataset_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation showing all config attributes.&quot;&quot;&quot;</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">attrs</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.tabs.link", "navigation.sections"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>